{"ast":null,"code":"import _objectSpread from\"/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import'./AdminDashboard.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE_URL='http://localhost:8081/api/admin/keycloak';/**\n * Keycloak Admin Dashboard\n * User-friendly interface for managing Keycloak without accessing the admin console\n */const KeycloakAdminDashboard=()=>{const{user,refreshTokenIfNeeded,loading:authLoading}=useAuth();const[activeTab,setActiveTab]=useState('users');const[users,setUsers]=useState([]);const[roles,setRoles]=useState([]);const[resources,setResources]=useState([]);const[policies,setPolicies]=useState([]);const[permissions,setPermissions]=useState([]);const[groups,setGroups]=useState([]);const[features,setFeatures]=useState([]);const[featurePermissions,setFeaturePermissions]=useState([]);const[myFeaturePermissions,setMyFeaturePermissions]=useState([]);// Current user's permissions\nconst[selectedFeature,setSelectedFeature]=useState(null);const[loading,setLoading]=useState(false);const[message,setMessage]=useState({type:'',text:''});// User form state\nconst[userForm,setUserForm]=useState({username:'',email:'',password:'',firstName:'',lastName:'',role:''});// Policy form state\nconst[policyForm,setPolicyForm]=useState({name:'',description:'',roleName:'PROVIDER'});// Permission form state\nconst[permissionForm,setPermissionForm]=useState({name:'',description:'',resourceId:'',scopeIds:[],policyIds:[]});// State for editing resource attributes\nconst[editingResource,setEditingResource]=useState(null);const[attributeForm,setAttributeForm]=useState({key:'',value:''});const[editingAttribute,setEditingAttribute]=useState(null);// { resourceId, oldKey, key, value }\nconst[attributeEditForm,setAttributeEditForm]=useState({key:'',value:''});// Role form state\nconst[roleForm,setRoleForm]=useState({name:'',description:''});// Group form state\nconst[groupForm,setGroupForm]=useState({name:'',parentGroupId:''});const[selectedGroupMembers,setSelectedGroupMembers]=useState({});// { groupId: [members] }\n// Feature Permission form state\nconst[featurePermissionForm,setFeaturePermissionForm]=useState({featureName:'',grantedToRole:'',allowedRoles:[],allowedCounties:[],restrictToOwnCounty:false,limitations:'',enabled:true});const getAuthHeaders=async()=>{// Admin endpoints now require user authentication with ADMIN role\nconst token=await refreshTokenIfNeeded();return{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'};};const showMessage=(type,text)=>{setMessage({type,text});setTimeout(()=>setMessage({type:'',text:''}),5000);};const handleApiError=(error,defaultMessage)=>{var _error$response,_error$response2,_error$response2$data;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){showMessage('error','Session expired. Please login again.');// Don't show the default message for 401 errors\nreturn;}showMessage('error',defaultMessage+': '+(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message));};// ============================== USER MANAGEMENT ==============================\nconst fetchUsers=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/users\"),{headers:await getAuthHeaders()});setUsers(response.data);}catch(error){handleApiError(error,'Failed to fetch users');}finally{setLoading(false);}};const createUser=async e=>{e.preventDefault();// Validate that a role is selected\nif(!userForm.role){showMessage('error','Please select a role for the user');return;}setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/users\"),userForm,{headers:await getAuthHeaders()});showMessage('success',response.data.message||'User created successfully');setUserForm({username:'',email:'',password:'',firstName:'',lastName:'',role:'',countyCode:''});fetchUsers();}catch(error){var _error$response3,_error$response3$data;showMessage('error','Failed to create user: '+(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||error.message));}finally{setLoading(false);}};const deleteUser=async(userId,username)=>{if(!window.confirm(\"Are you sure you want to delete user: \".concat(username,\"?\"))){return;}setLoading(true);try{await axios.delete(\"\".concat(API_BASE_URL,\"/users/\").concat(userId),{headers:await getAuthHeaders()});showMessage('success','User deleted successfully');fetchUsers();}catch(error){var _error$response4,_error$response4$data;showMessage('error','Failed to delete user: '+(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||error.message));}finally{setLoading(false);}};// ============================== ROLE MANAGEMENT ==============================\nconst fetchRoles=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/roles\"),{headers:await getAuthHeaders()});setRoles(response.data||[]);}catch(error){console.error('Error fetching roles:',error);// Check if user is admin\nconst userIsAdmin=user&&user.roles&&user.roles.includes('ADMIN');// Don't show error message if user is not admin - they might not need all roles\nif(userIsAdmin){handleApiError(error,'Failed to fetch roles');}else{// For non-admin users, set empty roles array - they'll only see roles from permission\nsetRoles([]);}}finally{setLoading(false);}};// ============================== RESOURCE ATTRIBUTE MANAGEMENT ==============================\nconst addResourceAttribute=async(resourceId,resourceName)=>{if(!attributeForm.key||!attributeForm.value){showMessage('error','Both key and value are required');return;}try{setLoading(true);const response=await axios.post(\"\".concat(API_BASE_URL,\"/resources/\").concat(resourceId,\"/attributes\"),{key:attributeForm.key,value:attributeForm.value},{headers:await getAuthHeaders()});showMessage('success',\"Attribute added to \".concat(resourceName));setAttributeForm({key:'',value:''});setEditingResource(null);fetchResources();// Refresh resources\n}catch(error){var _error$response5,_error$response5$data;console.error('Error adding attribute:',error);showMessage('error',((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.message)||'Failed to add attribute');}finally{setLoading(false);}};const deleteResourceAttribute=async(resourceId,resourceName,attributeKey)=>{if(!window.confirm(\"Are you sure you want to delete attribute \\\"\".concat(attributeKey,\"\\\" from \").concat(resourceName,\"?\"))){return;}try{setLoading(true);await axios.delete(\"\".concat(API_BASE_URL,\"/resources/\").concat(resourceId,\"/attributes/\").concat(attributeKey),{headers:await getAuthHeaders()});showMessage('success',\"Attribute \\\"\".concat(attributeKey,\"\\\" deleted from \").concat(resourceName));fetchResources();// Refresh resources\n}catch(error){var _error$response6,_error$response6$data;console.error('Error deleting attribute:',error);showMessage('error',((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.message)||'Failed to delete attribute');}finally{setLoading(false);}};const startEditAttribute=(resourceId,key,value)=>{setEditingAttribute({resourceId,oldKey:key});setAttributeEditForm({key,value});};const cancelEditAttribute=()=>{setEditingAttribute(null);setAttributeEditForm({key:'',value:''});};const updateResourceAttribute=async(resourceId,resourceName)=>{if(!attributeEditForm.key||!attributeEditForm.value){showMessage('error','Both key and value are required');return;}try{setLoading(true);// Get current resource to access all attributes\nconst currentResource=resources.find(r=>r._id===resourceId);if(!currentResource){showMessage('error','Resource not found');return;}// Create updated attributes map\nconst updatedAttributes=_objectSpread({},currentResource.attributes);console.log('ðŸ” Current attributes before update:',currentResource.attributes);console.log('ðŸ” Editing attribute:',editingAttribute);console.log('ðŸ” Edit form data:',attributeEditForm);// If key changed, remove old key\nif(editingAttribute.oldKey!==attributeEditForm.key){delete updatedAttributes[editingAttribute.oldKey];}// Add/update the attribute - handle Keycloak's array format\n// Keycloak stores attributes as arrays, so we need to convert comma-separated values to array\nconst valueArray=attributeEditForm.value.split(',').map(v=>v.trim()).filter(v=>v.length>0);updatedAttributes[attributeEditForm.key]=valueArray;console.log('ðŸ” Updated attributes to send:',updatedAttributes);// Send PUT request with all attributes\nawait axios.put(\"\".concat(API_BASE_URL,\"/resources/\").concat(resourceId,\"/attributes\"),updatedAttributes,{headers:await getAuthHeaders()});showMessage('success',\"Attribute updated in \".concat(resourceName));setEditingAttribute(null);setAttributeEditForm({key:'',value:''});fetchResources();// Refresh resources\n}catch(error){var _error$response7,_error$response7$data;console.error('Error updating attribute:',error);showMessage('error',((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.message)||'Failed to update attribute');}finally{setLoading(false);}};// ============================== ROLE MANAGEMENT ==============================\nconst createRole=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/roles\"),roleForm,{headers:await getAuthHeaders()});showMessage('success',response.data.message||'Role created successfully');setRoleForm({name:'',description:''});fetchRoles();}catch(error){var _error$response8,_error$response8$data;showMessage('error','Failed to create role: '+(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.message)||error.message));}finally{setLoading(false);}};const deleteRole=async(roleId,roleName)=>{if(!window.confirm(\"Are you sure you want to delete role \\\"\".concat(roleName,\"\\\"? This action cannot be undone.\"))){return;}try{setLoading(true);await axios.delete(\"\".concat(API_BASE_URL,\"/roles/\").concat(roleId),{headers:await getAuthHeaders()});showMessage('success',\"Role \\\"\".concat(roleName,\"\\\" deleted successfully\"));fetchRoles();}catch(error){var _error$response9,_error$response9$data;showMessage('error','Failed to delete role: '+(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.message)||error.message));}finally{setLoading(false);}};// Process attributes to handle Keycloak's format where same key can have multiple values\nconst processResourceAttributes=attributes=>{if(!attributes)return{};const processed={};// Handle different attribute formats from Keycloak\nif(Array.isArray(attributes)){// If attributes is an array of objects with key/value pairs\nattributes.forEach(attr=>{if(attr.key&&attr.value){if(!processed[attr.key]){processed[attr.key]=[];}processed[attr.key].push(attr.value);}});}else if(typeof attributes==='object'){// If attributes is already a map\nObject.entries(attributes).forEach(_ref=>{let[key,value]=_ref;if(Array.isArray(value)){processed[key]=value;}else{processed[key]=[value];}});}return processed;};// ============================== AUTHORIZATION MANAGEMENT ==============================\nconst fetchResources=async()=>{setLoading(true);try{var _response$data$;const response=await axios.get(\"\".concat(API_BASE_URL,\"/resources\"),{headers:await getAuthHeaders()});console.log('ðŸ” Raw resources data:',response.data);console.log('ðŸ” First resource attributes:',(_response$data$=response.data[0])===null||_response$data$===void 0?void 0:_response$data$.attributes);// Process attributes for each resource\nconst processedResources=response.data.map(resource=>_objectSpread(_objectSpread({},resource),{},{attributes:processResourceAttributes(resource.attributes)}));console.log('ðŸ” Processed resources:',processedResources);setResources(processedResources);}catch(error){handleApiError(error,'Failed to fetch resources');}finally{setLoading(false);}};const fetchPolicies=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/policies\"),{headers:await getAuthHeaders()});setPolicies(response.data);}catch(error){handleApiError(error,'Failed to fetch policies');}finally{setLoading(false);}};const createPolicy=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/policies\"),policyForm,{headers:await getAuthHeaders()});showMessage('success',response.data.message||'Policy created successfully');setPolicyForm({name:'',description:'',roleName:'PROVIDER'});fetchPolicies();}catch(error){var _error$response0,_error$response0$data;showMessage('error','Failed to create policy: '+(((_error$response0=error.response)===null||_error$response0===void 0?void 0:(_error$response0$data=_error$response0.data)===null||_error$response0$data===void 0?void 0:_error$response0$data.message)||error.message));}finally{setLoading(false);}};const fetchPermissions=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/permissions\"),{headers:await getAuthHeaders()});setPermissions(response.data);}catch(error){handleApiError(error,'Failed to fetch permissions');}finally{setLoading(false);}};const createPermission=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/permissions\"),permissionForm,{headers:await getAuthHeaders()});showMessage('success',response.data.message||'Permission created successfully');setPermissionForm({name:'',description:'',resourceId:'',scopeIds:[],policyIds:[]});fetchPermissions();}catch(error){var _error$response1,_error$response1$data;showMessage('error','Failed to create permission: '+(((_error$response1=error.response)===null||_error$response1===void 0?void 0:(_error$response1$data=_error$response1.data)===null||_error$response1$data===void 0?void 0:_error$response1$data.message)||error.message));}finally{setLoading(false);}};// ============================== GROUP MANAGEMENT ==============================\nconst fetchGroups=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/groups\"),{headers:await getAuthHeaders()});setGroups(response.data);}catch(error){handleApiError(error,'Failed to fetch groups');}finally{setLoading(false);}};const createGroup=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/groups\"),{name:groupForm.name,parentGroupId:groupForm.parentGroupId||null},{headers:await getAuthHeaders()});showMessage('success',response.data.message||'Group created successfully');setGroupForm({name:'',parentGroupId:''});fetchGroups();}catch(error){handleApiError(error,'Failed to create group');}finally{setLoading(false);}};const deleteGroup=async(groupId,groupName)=>{if(!window.confirm(\"Are you sure you want to delete group \\\"\".concat(groupName,\"\\\"?\"))){return;}setLoading(true);try{await axios.delete(\"\".concat(API_BASE_URL,\"/groups/\").concat(groupId),{headers:await getAuthHeaders()});showMessage('success','Group deleted successfully');fetchGroups();}catch(error){handleApiError(error,'Failed to delete group');}finally{setLoading(false);}};const fetchGroupMembers=async groupId=>{try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/groups/\").concat(groupId,\"/members\"),{headers:await getAuthHeaders()});setSelectedGroupMembers(prev=>_objectSpread(_objectSpread({},prev),{},{[groupId]:response.data}));}catch(error){handleApiError(error,'Failed to fetch group members');}};const addUserToGroup=async(userId,groupId)=>{setLoading(true);try{await axios.put(\"\".concat(API_BASE_URL,\"/users/\").concat(userId,\"/groups/\").concat(groupId),{},{headers:await getAuthHeaders()});showMessage('success','User added to group successfully');fetchGroupMembers(groupId);fetchUsers();}catch(error){handleApiError(error,'Failed to add user to group');}finally{setLoading(false);}};const removeUserFromGroup=async(userId,groupId)=>{setLoading(true);try{await axios.delete(\"\".concat(API_BASE_URL,\"/users/\").concat(userId,\"/groups/\").concat(groupId),{headers:await getAuthHeaders()});showMessage('success','User removed from group successfully');fetchGroupMembers(groupId);fetchUsers();}catch(error){handleApiError(error,'Failed to remove user from group');}finally{setLoading(false);}};// Helper function to flatten groups tree for display\nconst flattenGroups=function(groups){let level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;let result=[];groups.forEach(group=>{result.push(_objectSpread(_objectSpread({},group),{},{level}));if(group.subGroups&&group.subGroups.length>0){result=result.concat(flattenGroups(group.subGroups,level+1));}});return result;};// ============================== FEATURE PERMISSIONS ==============================\nconst fetchFeatures=async()=>{try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/features\"),{headers:await getAuthHeaders()});setFeatures(response.data.features||[]);}catch(error){handleApiError(error,'Failed to fetch features');}};const fetchFeaturePermissions=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/feature-permissions\"),{headers:await getAuthHeaders()});setFeaturePermissions(response.data||[]);}catch(error){handleApiError(error,'Failed to fetch feature permissions');}finally{setLoading(false);}};const fetchMyFeaturePermissions=async()=>{try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/my-feature-permissions\"),{headers:await getAuthHeaders()});setMyFeaturePermissions(response.data||[]);}catch(error){// Silently fail - user might not have permissions\nsetMyFeaturePermissions([]);}};const saveFeaturePermission=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(API_BASE_URL,\"/feature-permissions\"),featurePermissionForm,{headers:await getAuthHeaders()});showMessage('success',response.data.message||'Feature permission saved successfully');setFeaturePermissionForm({featureName:'',grantedToRole:'',allowedRoles:[],allowedCounties:[],restrictToOwnCounty:false,limitations:'',enabled:true});setSelectedFeature(null);fetchFeaturePermissions();}catch(error){handleApiError(error,'Failed to save feature permission');}finally{setLoading(false);}};const deleteFeaturePermission=async id=>{if(!window.confirm('Are you sure you want to delete this feature permission?')){return;}setLoading(true);try{await axios.delete(\"\".concat(API_BASE_URL,\"/feature-permissions/\").concat(id),{headers:await getAuthHeaders()});showMessage('success','Feature permission deleted successfully');fetchFeaturePermissions();}catch(error){handleApiError(error,'Failed to delete feature permission');}finally{setLoading(false);}};const handleFeatureSelect=featureName=>{setSelectedFeature(featureName);setFeaturePermissionForm(prev=>_objectSpread(_objectSpread({},prev),{},{featureName:featureName}));};// Load data based on active tab\nuseEffect(()=>{switch(activeTab){case'users':fetchUsers();fetchRoles();break;case'roles':fetchRoles();break;case'policies':fetchPolicies();fetchRoles();break;case'permissions':fetchPermissions();fetchResources();fetchPolicies();break;case'resources':fetchResources();break;case'groups':fetchGroups();fetchUsers();break;case'feature-permissions':fetchFeatures();fetchFeaturePermissions();fetchRoles();break;default:break;}},[activeTab]);// Fetch user's feature permissions on mount\nuseEffect(()=>{fetchMyFeaturePermissions();},[]);// ============================== RENDER ==============================\n// Show loading state while auth is initializing\nif(authLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"admin-container\",children:/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'50px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})]})});}// Check if user has ADMIN role OR has feature permissions\nconst isAdmin=user&&user.roles&&user.roles.includes('ADMIN');const hasFeaturePermissions=myFeaturePermissions.length>0;if(!user||!isAdmin&&!hasFeaturePermissions){var _user$roles;return/*#__PURE__*/_jsx(\"div\",{className:\"admin-container\",children:/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'50px'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDD12 Access Denied\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#e74c3c',fontSize:'1.2rem',marginBottom:'20px'},children:\"Administrator role or feature permissions required to access this page.\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You need the \",/*#__PURE__*/_jsx(\"strong\",{children:\"ADMIN\"}),\" role or granted feature permissions to access the Keycloak Administration interface.\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Current user:\"}),\" \",(user===null||user===void 0?void 0:user.username)||'Not logged in']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Current roles:\"}),\" \",(user===null||user===void 0?void 0:(_user$roles=user.roles)===null||_user$roles===void 0?void 0:_user$roles.join(', '))||'None']})]})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"admin-title\",children:\"\\uD83D\\uDD10 Keycloak Administration\"}),/*#__PURE__*/_jsx(\"p\",{className:\"admin-subtitle\",children:\"Manage users, roles, policies, and permissions without accessing Keycloak console\"}),message.text&&/*#__PURE__*/_jsx(\"div\",{className:\"message \".concat(message.type),children:message.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"tabs\",children:[(isAdmin||myFeaturePermissions.some(p=>p.featureName==='CREATE_USER'))&&/*#__PURE__*/_jsx(\"button\",{className:activeTab==='users'?'tab active':'tab',onClick:()=>setActiveTab('users'),children:\"\\uD83D\\uDC65 Users\"}),isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:activeTab==='roles'?'tab active':'tab',onClick:()=>setActiveTab('roles'),children:\"\\uD83D\\uDC64 Roles\"}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='policies'?'tab active':'tab',onClick:()=>setActiveTab('policies'),children:\"\\uD83D\\uDCCB Policies\"}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='permissions'?'tab active':'tab',onClick:()=>setActiveTab('permissions'),children:\"\\uD83D\\uDD11 Permissions\"}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='resources'?'tab active':'tab',onClick:()=>setActiveTab('resources'),children:\"\\uD83D\\uDCE6 Resources\"}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='groups'?'tab active':'tab',onClick:()=>setActiveTab('groups'),children:\"\\uD83D\\uDC65 Groups\"}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='feature-permissions'?'tab active':'tab',onClick:()=>setActiveTab('feature-permissions'),children:\"\\u2699\\uFE0F Feature Permissions\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[activeTab==='users'&&(()=>{// Get CREATE_USER permission for current user\nconst createUserPermission=(myFeaturePermissions||[]).find(p=>p.featureName==='CREATE_USER');// Parse allowed roles and counties\nlet allowedRolesList=[];let allowedCountiesList=[];if(createUserPermission){try{if(createUserPermission.allowedRoles){allowedRolesList=JSON.parse(createUserPermission.allowedRoles);}}catch(e){allowedRolesList=createUserPermission.allowedRoles?createUserPermission.allowedRoles.split(','):[];}try{if(createUserPermission.allowedCounties){allowedCountiesList=JSON.parse(createUserPermission.allowedCounties);}}catch(e){allowedCountiesList=createUserPermission.allowedCounties?createUserPermission.allowedCounties.split(','):[];}}// Get user's counties from JWT (if restrictToOwnCounty is true)\nconst userCounties=(user===null||user===void 0?void 0:user.locations)||[];const restrictToOwnCounty=(createUserPermission===null||createUserPermission===void 0?void 0:createUserPermission.restrictToOwnCounty)||false;const effectiveAllowedCounties=restrictToOwnCounty?userCounties:allowedCountiesList.length>0?allowedCountiesList:[];// Filter roles based on permission\n// For non-admin users: Only show roles that are configured in the feature permission\n// Create role objects from allowedRolesList if roles haven't been fetched yet\nlet availableRoles=[];if(isAdmin){// Admin sees all roles\navailableRoles=roles.filter(role=>!role.name.startsWith('default-')&&!role.name.includes('uma_')&&!role.name.includes('offline_'));}else{// Non-admin users: Only show roles from allowedRolesList\nif(allowedRolesList.length>0){// Try to find roles from the fetched roles list\navailableRoles=roles.filter(role=>!role.name.startsWith('default-')&&!role.name.includes('uma_')&&!role.name.includes('offline_')&&allowedRolesList.includes(role.name));// If roles haven't been fetched yet or some roles are missing, create placeholder objects\nconst fetchedRoleNames=availableRoles.map(r=>r.name);const missingRoles=allowedRolesList.filter(roleName=>!fetchedRoleNames.includes(roleName));// Add placeholder role objects for roles that haven't been fetched\nmissingRoles.forEach(roleName=>{availableRoles.push({id:roleName,// Use role name as ID temporarily\nname:roleName,description:''});});}else{// No allowed roles configured\navailableRoles=[];}}// Debug logging\nconsole.log('Role filtering debug:',{isAdmin,totalRoles:roles.length,allowedRolesList,availableRolesCount:availableRoles.length,availableRoles:availableRoles.map(r=>r.name)});return/*#__PURE__*/_jsxs(\"div\",{children:[!isAdmin&&createUserPermission&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'15px',backgroundColor:'#fff3cd',border:'1px solid #ffc107',borderRadius:'5px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontWeight:'bold'},children:\"\\u26A0\\uFE0F Limited Access\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'5px 0 0 0',fontSize:'0.9em'},children:\"You can only create users with the following restrictions:\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{margin:'5px 0 0 20px',fontSize:'0.9em'},children:[allowedRolesList.length>0&&/*#__PURE__*/_jsxs(\"li\",{children:[\"Allowed Roles: \",allowedRolesList.join(', ')]}),effectiveAllowedCounties.length>0&&/*#__PURE__*/_jsxs(\"li\",{children:[\"Allowed Counties: \",effectiveAllowedCounties.join(', ')]}),restrictToOwnCounty&&/*#__PURE__*/_jsx(\"li\",{children:\"Restricted to your assigned counties only\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Create New User\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createUser,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:userForm.username,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{username:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:userForm.email,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{email:e.target.value})),required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:userForm.firstName,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{firstName:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:userForm.lastName,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{lastName:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:userForm.password,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{password:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role *\"}),/*#__PURE__*/_jsxs(\"select\",{value:userForm.role,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{role:e.target.value})),required:true,disabled:!isAdmin&&availableRoles.length===0,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a role\"}),availableRoles.length>0?availableRoles.map(role=>/*#__PURE__*/_jsxs(\"option\",{value:role.name,children:[role.name,\" \",role.description?\"- \".concat(role.description):'']},role.id)):/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:!isAdmin&&allowedRolesList.length===0?'No roles configured. Please contact admin to configure allowed roles.':'Loading roles...'})]}),!isAdmin&&/*#__PURE__*/_jsx(\"small\",{style:{color:allowedRolesList.length>0?'#666':'#dc3545',display:'block',marginTop:'5px'},children:allowedRolesList.length>0?\"You can only create users with roles: \".concat(allowedRolesList.join(', ')):'âš ï¸ No roles are configured for your permission. Please contact an administrator.'})]})]}),effectiveAllowedCounties.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"County *\"}),/*#__PURE__*/_jsxs(\"select\",{value:userForm.countyCode,onChange:e=>setUserForm(_objectSpread(_objectSpread({},userForm),{},{countyCode:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a county\"}),effectiveAllowedCounties.map(county=>/*#__PURE__*/_jsx(\"option\",{value:county,children:county},county))]})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Creating...':'Create User'})]}),isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Existing Users\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading users...\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Enabled\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.username}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:user.firstName||'-'}),/*#__PURE__*/_jsx(\"td\",{children:user.lastName||'-'}),/*#__PURE__*/_jsx(\"td\",{children:user.enabled?'âœ… Yes':'âŒ No'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteUser(user.id,user.username),className:\"btn-danger-small\",children:\"Delete\"})})]},user.id))})]})]})]});})(),activeTab==='roles'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Role\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createRole,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:roleForm.name,onChange:e=>setRoleForm(_objectSpread(_objectSpread({},roleForm),{},{name:e.target.value})),placeholder:\"e.g., MANAGER, SUPERVISOR\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:roleForm.description,onChange:e=>setRoleForm(_objectSpread(_objectSpread({},roleForm),{},{description:e.target.value})),placeholder:\"e.g., Manager role with full access\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Creating...':'Create Role'})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Existing Roles\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading roles...\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:roles.filter(role=>!role.name.startsWith('default-')&&!role.name.includes('uma_')&&!role.name.includes('offline_')).map(role=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:role.name})}),/*#__PURE__*/_jsx(\"td\",{children:role.description||'-'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteRole(role.id,role.name),className:\"btn-danger-small\",title:\"Delete role\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})})]},role.id))})]})]}),activeTab==='policies'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Policy\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createPolicy,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Policy Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:policyForm.name,onChange:e=>setPolicyForm(_objectSpread(_objectSpread({},policyForm),{},{name:e.target.value})),placeholder:\"e.g., Recipient Read Policy\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:policyForm.description,onChange:e=>setPolicyForm(_objectSpread(_objectSpread({},policyForm),{},{description:e.target.value})),placeholder:\"e.g., Allows recipients to read timesheets\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role *\"}),/*#__PURE__*/_jsx(\"select\",{value:policyForm.roleName,onChange:e=>setPolicyForm(_objectSpread(_objectSpread({},policyForm),{},{roleName:e.target.value})),children:roles.filter(r=>!r.name.startsWith('default-')).map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.name,children:role.name},role.id))})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Creating...':'Create Policy'})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Existing Policies\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading policies...\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Logic\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:policies.map(policy=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:policy.name}),/*#__PURE__*/_jsx(\"td\",{children:policy.type}),/*#__PURE__*/_jsx(\"td\",{children:policy.description||'-'}),/*#__PURE__*/_jsx(\"td\",{children:policy.logic})]},policy.id))})]})]}),activeTab==='permissions'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Permission\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createPermission,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Permission Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:permissionForm.name,onChange:e=>setPermissionForm(_objectSpread(_objectSpread({},permissionForm),{},{name:e.target.value})),placeholder:\"e.g., Recipient Read Timesheets\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:permissionForm.description,onChange:e=>setPermissionForm(_objectSpread(_objectSpread({},permissionForm),{},{description:e.target.value})),placeholder:\"e.g., Allows recipients to read timesheet data\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Resource *\"}),/*#__PURE__*/_jsxs(\"select\",{value:permissionForm.resourceId,onChange:e=>setPermissionForm(_objectSpread(_objectSpread({},permissionForm),{},{resourceId:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a resource\"}),resources.map(resource=>/*#__PURE__*/_jsx(\"option\",{value:resource._id,children:resource.name},resource._id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Scopes * (comma-separated scope IDs)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:permissionForm.scopeIds.join(','),onChange:e=>setPermissionForm(_objectSpread(_objectSpread({},permissionForm),{},{scopeIds:e.target.value.split(',').map(s=>s.trim()).filter(s=>s)})),placeholder:\"e.g., scope-id-1, scope-id-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Policies * (comma-separated policy IDs)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:permissionForm.policyIds.join(','),onChange:e=>setPermissionForm(_objectSpread(_objectSpread({},permissionForm),{},{policyIds:e.target.value.split(',').map(s=>s.trim()).filter(s=>s)})),placeholder:\"e.g., policy-id-1, policy-id-2\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Creating...':'Create Permission'})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Existing Permissions\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading permissions...\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Decision Strategy\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:permissions.map(permission=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:permission.name}),/*#__PURE__*/_jsx(\"td\",{children:permission.type}),/*#__PURE__*/_jsx(\"td\",{children:permission.description||'-'}),/*#__PURE__*/_jsx(\"td\",{children:permission.decisionStrategy})]},permission.id))})]})]}),activeTab==='resources'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Resources & Attributes\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading resources...\"}):/*#__PURE__*/_jsx(\"div\",{children:resources.map(resource=>{var _resource$uris;return/*#__PURE__*/_jsxs(\"div\",{className:\"resource-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:resource.name}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Type:\"}),\" \",resource.type||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"URIs:\"}),\" \",((_resource$uris=resource.uris)===null||_resource$uris===void 0?void 0:_resource$uris.join(', '))||'-']}),resource.scopes&&resource.scopes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scopes:\"}),/*#__PURE__*/_jsx(\"ul\",{children:resource.scopes.map(scope=>/*#__PURE__*/_jsxs(\"li\",{children:[scope.name,\" (ID: \",scope.id,\")\"]},scope.id))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Attributes:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingResource(resource._id);setAttributeForm({key:'',value:''});},className:\"btn-primary-small\",style:{fontSize:'12px',padding:'5px 10px'},children:\"\\u2795 Add Attribute\"})]}),editingResource===resource._id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',padding:'15px',backgroundColor:'#f0f8ff',border:'1px solid #ccc',borderRadius:'5px'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:0},children:\"Add New Attribute\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px',alignItems:'flex-end'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'bold'},children:\"Attribute Key *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:attributeForm.key,onChange:e=>setAttributeForm(_objectSpread(_objectSpread({},attributeForm),{},{key:e.target.value})),placeholder:\"e.g., recipient_read_fields\",style:{width:'100%',padding:'8px',border:'1px solid #ccc',borderRadius:'4px'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'bold'},children:\"Attribute Value *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:attributeForm.value,onChange:e=>setAttributeForm(_objectSpread(_objectSpread({},attributeForm),{},{value:e.target.value})),placeholder:\"e.g., id,date,hours\",style:{width:'100%',padding:'8px',border:'1px solid #ccc',borderRadius:'4px'}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addResourceAttribute(resource._id,resource.name),className:\"btn-primary\",disabled:loading||!attributeForm.key||!attributeForm.value,style:{padding:'8px 15px'},children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingResource(null);setAttributeForm({key:'',value:''});},className:\"btn-secondary\",style:{padding:'8px 15px'},children:\"Cancel\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'12px',color:'#666',marginTop:'10px',marginBottom:0},children:[\"\\uD83D\\uDCA1 Tip: For field-level authorization, use format: \",/*#__PURE__*/_jsx(\"code\",{children:\"role_scope_fields\"}),\" (e.g., recipient_read_fields)\"]})]}),resource.attributes&&Object.keys(resource.attributes).length>0?/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',marginTop:'10px',borderCollapse:'collapse',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'#f5f5f5'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px',textAlign:'left',borderBottom:'2px solid #ddd',width:'30%'},children:\"Key\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px',textAlign:'left',borderBottom:'2px solid #ddd',width:'55%'},children:\"Value\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px',textAlign:'center',borderBottom:'2px solid #ddd',width:'15%'},children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Object.entries(resource.attributes).map(_ref2=>{let[key,value]=_ref2;const isEditing=(editingAttribute===null||editingAttribute===void 0?void 0:editingAttribute.resourceId)===resource._id&&(editingAttribute===null||editingAttribute===void 0?void 0:editingAttribute.oldKey)===key;return/*#__PURE__*/_jsx(\"tr\",{style:{borderBottom:'1px solid #eee'},children:isEditing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:attributeEditForm.key,onChange:e=>setAttributeEditForm(_objectSpread(_objectSpread({},attributeEditForm),{},{key:e.target.value})),placeholder:\"Attribute key\",style:{width:'100%',padding:'5px'}})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:attributeEditForm.value,onChange:e=>setAttributeEditForm(_objectSpread(_objectSpread({},attributeEditForm),{},{value:e.target.value})),placeholder:\"Attribute value\",style:{width:'100%',padding:'5px'}})}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateResourceAttribute(resource._id,resource.name),className:\"btn-primary-small\",style:{marginRight:'8px',fontSize:'12px',padding:'6px 12px',backgroundColor:'#28a745',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},title:\"Save changes\",children:\"\\u2705 Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEditAttribute,className:\"btn-secondary-small\",style:{fontSize:'12px',padding:'6px 12px',backgroundColor:'#6c757d',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},title:\"Cancel editing\",children:\"\\u274C Cancel\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px'},children:/*#__PURE__*/_jsx(\"strong\",{children:key})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',fontFamily:'monospace',color:'#0066cc'},children:Array.isArray(value)?value.join(', '):value}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEditAttribute(resource._id,key,Array.isArray(value)?value.join(', '):value),className:\"btn-secondary-small\",style:{marginRight:'8px',fontSize:'12px',padding:'6px 12px',backgroundColor:'#6c757d',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},title:\"Edit attribute\",children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteResourceAttribute(resource._id,resource.name,key),className:\"btn-danger-small\",style:{fontSize:'12px',padding:'6px 12px',backgroundColor:'#dc3545',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},title:\"Delete attribute\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]})]})},key);})})]}):/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontStyle:'italic',marginTop:'10px',padding:'10px',backgroundColor:'#f9f9f9',borderRadius:'4px'},children:\"No attributes defined. Click \\\"Add Attribute\\\" to add field-level authorization rules.\"})]})]},resource._id);})})]}),activeTab==='groups'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Group\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createGroup,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Group Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:groupForm.name,onChange:e=>setGroupForm(_objectSpread(_objectSpread({},groupForm),{},{name:e.target.value})),placeholder:\"e.g., County-CTA\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Creating...':'Create Group'})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Existing Groups\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading groups...\"}):/*#__PURE__*/_jsx(\"div\",{children:groups.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No groups found. Create a group to get started.\"}):flattenGroups(groups).map(group=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',padding:'15px',border:'1px solid #ddd',borderRadius:'5px',backgroundColor:'#f9f9f9',marginLeft:\"\".concat((group.level||0)*20,\"px\")},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'0 0 10px 0'},children:[group.name,group.path&&/*#__PURE__*/_jsxs(\"span\",{style:{color:'#666',fontSize:'0.9em',marginLeft:'10px'},children:[\"(\",group.path,\")\"]})]}),group.subGroups&&group.subGroups.length>0&&/*#__PURE__*/_jsxs(\"p\",{style:{color:'#666',fontSize:'0.9em',margin:0},children:[group.subGroups.length,\" sub-group\",group.subGroups.length!==1?'s':'']})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(selectedGroupMembers[group.id]){setSelectedGroupMembers(prev=>{const newState=_objectSpread({},prev);delete newState[group.id];return newState;});}else{fetchGroupMembers(group.id);}},className:\"btn-primary-small\",style:{marginRight:'10px'},children:selectedGroupMembers[group.id]?'ðŸ‘ï¸ Hide Members':'ðŸ‘¥ View Members'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteGroup(group.id,group.name),className:\"btn-danger-small\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]})]}),selectedGroupMembers[group.id]&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px',padding:'15px',backgroundColor:'white',borderRadius:'5px'},children:[/*#__PURE__*/_jsxs(\"h4\",{style:{marginTop:0},children:[\"Group Members (\",selectedGroupMembers[group.id].length,\")\"]}),selectedGroupMembers[group.id].length===0?/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontStyle:'italic'},children:\"No members in this group.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",style:{marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:selectedGroupMembers[group.id].map(member=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:member.username}),/*#__PURE__*/_jsx(\"td\",{children:member.email}),/*#__PURE__*/_jsx(\"td\",{children:member.firstName||'-'}),/*#__PURE__*/_jsx(\"td\",{children:member.lastName||'-'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeUserFromGroup(member.id,group.id),className:\"btn-danger-small\",children:\"Remove\"})})]},member.id))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px',padding:'15px',backgroundColor:'#f0f8ff',borderRadius:'5px'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:0},children:\"Add User to Group\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>{if(e.target.value){addUserToGroup(e.target.value,group.id);e.target.value='';}},style:{width:'100%',padding:'8px',marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a user to add...\"}),users.filter(user=>{var _selectedGroupMembers;return!((_selectedGroupMembers=selectedGroupMembers[group.id])!==null&&_selectedGroupMembers!==void 0&&_selectedGroupMembers.some(m=>m.id===user.id));}).map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.id,children:[user.username,\" (\",user.email,\")\"]},user.id))]})]})]})]},group.id))})]}),activeTab==='feature-permissions'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Available Features\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',marginBottom:'20px'},children:\"Select a feature to grant it to a role with specific limitations\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(200px, 1fr))',gap:'15px',marginBottom:'30px'},children:features.map(feature=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleFeatureSelect(feature),style:{padding:'20px',border:\"2px solid \".concat(selectedFeature===feature?'#007bff':'#ddd'),borderRadius:'8px',backgroundColor:selectedFeature===feature?'#e7f3ff':'#f9f9f9',cursor:'pointer',textAlign:'center',transition:'all 0.3s',boxShadow:selectedFeature===feature?'0 4px 8px rgba(0,123,255,0.2)':'none'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 10px 0',color:selectedFeature===feature?'#007bff':'#333'},children:feature.replace(/_/g,' ')}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontSize:'0.9em',color:'#666'},children:[featurePermissions.filter(fp=>fp.featureName===feature).length,\" permission(s) configured\"]})]},feature))}),selectedFeature&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px',padding:'20px',backgroundColor:'#f0f8ff',borderRadius:'8px',border:'1px solid #007bff'},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Grant \\\"\",selectedFeature.replace(/_/g,' '),\"\\\" to Role\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:saveFeaturePermission,className:\"admin-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Feature *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:selectedFeature,disabled:true,style:{backgroundColor:'#e9ecef'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Grant to Role *\"}),/*#__PURE__*/_jsxs(\"select\",{value:featurePermissionForm.grantedToRole,onChange:e=>setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{grantedToRole:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a role\"}),roles.filter(role=>!role.name.startsWith('default-')&&!role.name.includes('uma_')&&!role.name.includes('offline_')).map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.name,children:role.name},role.id))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Allowed Roles (for user creation features)\"}),/*#__PURE__*/_jsx(\"select\",{multiple:true,value:featurePermissionForm.allowedRoles,onChange:e=>{const selected=Array.from(e.target.selectedOptions,option=>option.value);setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{allowedRoles:selected}));},style:{minHeight:'100px'},children:roles.filter(role=>!role.name.startsWith('default-')&&!role.name.includes('uma_')&&!role.name.includes('offline_')).map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.name,children:role.name},role.id))}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:\"Hold Ctrl/Cmd to select multiple roles\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Allowed Counties\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:featurePermissionForm.allowedCounties.join(','),onChange:e=>setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{allowedCounties:e.target.value.split(',').map(c=>c.trim()).filter(c=>c)})),placeholder:\"e.g., CTA, CTB, CTC (comma-separated)\"}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:\"Leave empty to allow all counties\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'10px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:featurePermissionForm.restrictToOwnCounty,onChange:e=>setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{restrictToOwnCounty:e.target.checked}))}),\"Restrict to User's Own County Only\"]}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:\"If checked, users can only access resources from their assigned county\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Additional Limitations (JSON)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:featurePermissionForm.limitations,onChange:e=>setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{limitations:e.target.value})),placeholder:\"{\\\"maxUsersPerDay\\\": 10, \\\"requireApproval\\\": true}\",rows:3}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:\"Optional: JSON object for feature-specific limitations\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'10px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:featurePermissionForm.enabled,onChange:e=>setFeaturePermissionForm(_objectSpread(_objectSpread({},featurePermissionForm),{},{enabled:e.target.checked}))}),\"Enabled\"]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Saving...':'Save Permission'})]})]}),/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'40px'},children:\"Existing Feature Permissions\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading permissions...\"}):/*#__PURE__*/_jsx(\"div\",{children:featurePermissions.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No feature permissions configured. Select a feature above to grant permissions.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Feature\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Granted To Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Allowed Roles\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Allowed Counties\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Restrict to Own County\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Enabled\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:featurePermissions.map(permission=>{let allowedRolesList=[];let allowedCountiesList=[];try{if(permission.allowedRoles){allowedRolesList=JSON.parse(permission.allowedRoles);}}catch(e){allowedRolesList=permission.allowedRoles?permission.allowedRoles.split(','):[];}try{if(permission.allowedCounties){allowedCountiesList=JSON.parse(permission.allowedCounties);}}catch(e){allowedCountiesList=permission.allowedCounties?permission.allowedCounties.split(','):[];}return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:permission.featureName.replace(/_/g,' ')})}),/*#__PURE__*/_jsx(\"td\",{children:permission.grantedToRole}),/*#__PURE__*/_jsx(\"td\",{children:allowedRolesList.length>0?allowedRolesList.join(', '):'All'}),/*#__PURE__*/_jsx(\"td\",{children:allowedCountiesList.length>0?allowedCountiesList.join(', '):'All'}),/*#__PURE__*/_jsx(\"td\",{children:permission.restrictToOwnCounty?'âœ… Yes':'âŒ No'}),/*#__PURE__*/_jsx(\"td\",{children:permission.enabled?'âœ… Yes':'âŒ No'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteFeaturePermission(permission.id),className:\"btn-danger-small\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})})]},permission.id);})})]})})]})]})]});};export default KeycloakAdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE_URL","KeycloakAdminDashboard","user","refreshTokenIfNeeded","loading","authLoading","activeTab","setActiveTab","users","setUsers","roles","setRoles","resources","setResources","policies","setPolicies","permissions","setPermissions","groups","setGroups","features","setFeatures","featurePermissions","setFeaturePermissions","myFeaturePermissions","setMyFeaturePermissions","selectedFeature","setSelectedFeature","setLoading","message","setMessage","type","text","userForm","setUserForm","username","email","password","firstName","lastName","role","policyForm","setPolicyForm","name","description","roleName","permissionForm","setPermissionForm","resourceId","scopeIds","policyIds","editingResource","setEditingResource","attributeForm","setAttributeForm","key","value","editingAttribute","setEditingAttribute","attributeEditForm","setAttributeEditForm","roleForm","setRoleForm","groupForm","setGroupForm","parentGroupId","selectedGroupMembers","setSelectedGroupMembers","featurePermissionForm","setFeaturePermissionForm","featureName","grantedToRole","allowedRoles","allowedCounties","restrictToOwnCounty","limitations","enabled","getAuthHeaders","token","concat","showMessage","setTimeout","handleApiError","error","defaultMessage","_error$response","_error$response2","_error$response2$data","response","status","data","fetchUsers","get","headers","createUser","e","preventDefault","post","countyCode","_error$response3","_error$response3$data","deleteUser","userId","window","confirm","delete","_error$response4","_error$response4$data","fetchRoles","console","userIsAdmin","includes","addResourceAttribute","resourceName","fetchResources","_error$response5","_error$response5$data","deleteResourceAttribute","attributeKey","_error$response6","_error$response6$data","startEditAttribute","oldKey","cancelEditAttribute","updateResourceAttribute","currentResource","find","r","_id","updatedAttributes","_objectSpread","attributes","log","valueArray","split","map","v","trim","filter","length","put","_error$response7","_error$response7$data","createRole","_error$response8","_error$response8$data","deleteRole","roleId","_error$response9","_error$response9$data","processResourceAttributes","processed","Array","isArray","forEach","attr","push","Object","entries","_ref","_response$data$","processedResources","resource","fetchPolicies","createPolicy","_error$response0","_error$response0$data","fetchPermissions","createPermission","_error$response1","_error$response1$data","fetchGroups","createGroup","deleteGroup","groupId","groupName","fetchGroupMembers","prev","addUserToGroup","removeUserFromGroup","flattenGroups","level","arguments","undefined","result","group","subGroups","fetchFeatures","fetchFeaturePermissions","fetchMyFeaturePermissions","saveFeaturePermission","deleteFeaturePermission","id","handleFeatureSelect","className","children","style","textAlign","padding","isAdmin","hasFeaturePermissions","_user$roles","color","fontSize","marginBottom","marginTop","join","some","p","onClick","createUserPermission","allowedRolesList","allowedCountiesList","JSON","parse","userCounties","locations","effectiveAllowedCounties","availableRoles","startsWith","fetchedRoleNames","missingRoles","totalRoles","availableRolesCount","backgroundColor","border","borderRadius","margin","fontWeight","onSubmit","onChange","target","required","disabled","display","county","placeholder","title","policy","logic","s","permission","decisionStrategy","_resource$uris","uris","scopes","scope","justifyContent","alignItems","gap","flex","width","keys","borderCollapse","borderBottom","_ref2","isEditing","marginRight","cursor","fontFamily","fontStyle","marginLeft","path","newState","member","_selectedGroupMembers","m","gridTemplateColumns","feature","transition","boxShadow","replace","fp","multiple","selected","from","selectedOptions","option","minHeight","c","checked","rows"],"sources":["/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/src/components/KeycloakAdminDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useAuth } from '../contexts/AuthContext';\nimport './AdminDashboard.css';\n\nconst API_BASE_URL = 'http://localhost:8081/api/admin/keycloak';\n\n/**\n * Keycloak Admin Dashboard\n * User-friendly interface for managing Keycloak without accessing the admin console\n */\nconst KeycloakAdminDashboard = () => {\n  const { user, refreshTokenIfNeeded, loading: authLoading } = useAuth();\n  const [activeTab, setActiveTab] = useState('users');\n  const [users, setUsers] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const [resources, setResources] = useState([]);\n  const [policies, setPolicies] = useState([]);\n  const [permissions, setPermissions] = useState([]);\n  const [groups, setGroups] = useState([]);\n  const [features, setFeatures] = useState([]);\n  const [featurePermissions, setFeaturePermissions] = useState([]);\n  const [myFeaturePermissions, setMyFeaturePermissions] = useState([]); // Current user's permissions\n  const [selectedFeature, setSelectedFeature] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState({ type: '', text: '' });\n\n  // User form state\n  const [userForm, setUserForm] = useState({\n    username: '',\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: '',\n    role: ''\n  });\n\n  // Policy form state\n  const [policyForm, setPolicyForm] = useState({\n    name: '',\n    description: '',\n    roleName: 'PROVIDER'\n  });\n\n  // Permission form state\n  const [permissionForm, setPermissionForm] = useState({\n    name: '',\n    description: '',\n    resourceId: '',\n    scopeIds: [],\n    policyIds: []\n  });\n\n  // State for editing resource attributes\n  const [editingResource, setEditingResource] = useState(null);\n  const [attributeForm, setAttributeForm] = useState({\n    key: '',\n    value: ''\n  });\n  const [editingAttribute, setEditingAttribute] = useState(null); // { resourceId, oldKey, key, value }\n  const [attributeEditForm, setAttributeEditForm] = useState({\n    key: '',\n    value: ''\n  });\n\n  // Role form state\n  const [roleForm, setRoleForm] = useState({\n    name: '',\n    description: ''\n  });\n\n  // Group form state\n  const [groupForm, setGroupForm] = useState({\n    name: '',\n    parentGroupId: ''\n  });\n  const [selectedGroupMembers, setSelectedGroupMembers] = useState({}); // { groupId: [members] }\n\n  // Feature Permission form state\n  const [featurePermissionForm, setFeaturePermissionForm] = useState({\n    featureName: '',\n    grantedToRole: '',\n    allowedRoles: [],\n    allowedCounties: [],\n    restrictToOwnCounty: false,\n    limitations: '',\n    enabled: true\n  });\n\n  const getAuthHeaders = async () => {\n    // Admin endpoints now require user authentication with ADMIN role\n    const token = await refreshTokenIfNeeded();\n    return {\n      'Authorization': `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    };\n  };\n\n  const showMessage = (type, text) => {\n    setMessage({ type, text });\n    setTimeout(() => setMessage({ type: '', text: '' }), 5000);\n  };\n\n  const handleApiError = (error, defaultMessage) => {\n    if (error.response?.status === 401) {\n      showMessage('error', 'Session expired. Please login again.');\n      // Don't show the default message for 401 errors\n      return;\n    }\n    showMessage('error', defaultMessage + ': ' + (error.response?.data?.message || error.message));\n  };\n\n  // ============================== USER MANAGEMENT ==============================\n\n  const fetchUsers = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/users`, {\n        headers: await getAuthHeaders()\n      });\n      setUsers(response.data);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch users');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createUser = async (e) => {\n    e.preventDefault();\n    \n    // Validate that a role is selected\n    if (!userForm.role) {\n      showMessage('error', 'Please select a role for the user');\n      return;\n    }\n    \n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/users`, userForm, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'User created successfully');\n      setUserForm({\n        username: '',\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: '',\n        role: '',\n        countyCode: ''\n      });\n      fetchUsers();\n    } catch (error) {\n      showMessage('error', 'Failed to create user: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteUser = async (userId, username) => {\n    if (!window.confirm(`Are you sure you want to delete user: ${username}?`)) {\n      return;\n    }\n    \n    setLoading(true);\n    try {\n      await axios.delete(`${API_BASE_URL}/users/${userId}`, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', 'User deleted successfully');\n      fetchUsers();\n    } catch (error) {\n      showMessage('error', 'Failed to delete user: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ============================== ROLE MANAGEMENT ==============================\n\n  const fetchRoles = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/roles`, {\n        headers: await getAuthHeaders()\n      });\n      setRoles(response.data || []);\n    } catch (error) {\n      console.error('Error fetching roles:', error);\n      // Check if user is admin\n      const userIsAdmin = user && user.roles && user.roles.includes('ADMIN');\n      // Don't show error message if user is not admin - they might not need all roles\n      if (userIsAdmin) {\n        handleApiError(error, 'Failed to fetch roles');\n      } else {\n        // For non-admin users, set empty roles array - they'll only see roles from permission\n        setRoles([]);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ============================== RESOURCE ATTRIBUTE MANAGEMENT ==============================\n\n  const addResourceAttribute = async (resourceId, resourceName) => {\n    if (!attributeForm.key || !attributeForm.value) {\n      showMessage('error', 'Both key and value are required');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const response = await axios.post(\n        `${API_BASE_URL}/resources/${resourceId}/attributes`,\n        {\n          key: attributeForm.key,\n          value: attributeForm.value\n        },\n        { headers: await getAuthHeaders() }\n      );\n\n      showMessage('success', `Attribute added to ${resourceName}`);\n      setAttributeForm({ key: '', value: '' });\n      setEditingResource(null);\n      fetchResources(); // Refresh resources\n    } catch (error) {\n      console.error('Error adding attribute:', error);\n      showMessage('error', error.response?.data?.message || 'Failed to add attribute');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteResourceAttribute = async (resourceId, resourceName, attributeKey) => {\n    if (!window.confirm(`Are you sure you want to delete attribute \"${attributeKey}\" from ${resourceName}?`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await axios.delete(\n        `${API_BASE_URL}/resources/${resourceId}/attributes/${attributeKey}`,\n        { headers: await getAuthHeaders() }\n      );\n\n      showMessage('success', `Attribute \"${attributeKey}\" deleted from ${resourceName}`);\n      fetchResources(); // Refresh resources\n    } catch (error) {\n      console.error('Error deleting attribute:', error);\n      showMessage('error', error.response?.data?.message || 'Failed to delete attribute');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const startEditAttribute = (resourceId, key, value) => {\n    setEditingAttribute({ resourceId, oldKey: key });\n    setAttributeEditForm({ key, value });\n  };\n\n  const cancelEditAttribute = () => {\n    setEditingAttribute(null);\n    setAttributeEditForm({ key: '', value: '' });\n  };\n\n  const updateResourceAttribute = async (resourceId, resourceName) => {\n    if (!attributeEditForm.key || !attributeEditForm.value) {\n      showMessage('error', 'Both key and value are required');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      \n      // Get current resource to access all attributes\n      const currentResource = resources.find(r => r._id === resourceId);\n      if (!currentResource) {\n        showMessage('error', 'Resource not found');\n        return;\n      }\n      \n      // Create updated attributes map\n      const updatedAttributes = { ...currentResource.attributes };\n      \n      console.log('ðŸ” Current attributes before update:', currentResource.attributes);\n      console.log('ðŸ” Editing attribute:', editingAttribute);\n      console.log('ðŸ” Edit form data:', attributeEditForm);\n      \n      // If key changed, remove old key\n      if (editingAttribute.oldKey !== attributeEditForm.key) {\n        delete updatedAttributes[editingAttribute.oldKey];\n      }\n      \n      // Add/update the attribute - handle Keycloak's array format\n      // Keycloak stores attributes as arrays, so we need to convert comma-separated values to array\n      const valueArray = attributeEditForm.value.split(',').map(v => v.trim()).filter(v => v.length > 0);\n      updatedAttributes[attributeEditForm.key] = valueArray;\n      \n      console.log('ðŸ” Updated attributes to send:', updatedAttributes);\n      \n      // Send PUT request with all attributes\n      await axios.put(\n        `${API_BASE_URL}/resources/${resourceId}/attributes`,\n        updatedAttributes,\n        { headers: await getAuthHeaders() }\n      );\n\n      showMessage('success', `Attribute updated in ${resourceName}`);\n      setEditingAttribute(null);\n      setAttributeEditForm({ key: '', value: '' });\n      fetchResources(); // Refresh resources\n    } catch (error) {\n      console.error('Error updating attribute:', error);\n      showMessage('error', error.response?.data?.message || 'Failed to update attribute');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ============================== ROLE MANAGEMENT ==============================\n\n  const createRole = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/roles`, roleForm, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'Role created successfully');\n      setRoleForm({\n        name: '',\n        description: ''\n      });\n      fetchRoles();\n    } catch (error) {\n      showMessage('error', 'Failed to create role: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteRole = async (roleId, roleName) => {\n    if (!window.confirm(`Are you sure you want to delete role \"${roleName}\"? This action cannot be undone.`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await axios.delete(`${API_BASE_URL}/roles/${roleId}`, {\n        headers: await getAuthHeaders()\n      });\n\n      showMessage('success', `Role \"${roleName}\" deleted successfully`);\n      fetchRoles();\n    } catch (error) {\n      showMessage('error', 'Failed to delete role: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Process attributes to handle Keycloak's format where same key can have multiple values\n  const processResourceAttributes = (attributes) => {\n    if (!attributes) return {};\n    \n    const processed = {};\n    \n    // Handle different attribute formats from Keycloak\n    if (Array.isArray(attributes)) {\n      // If attributes is an array of objects with key/value pairs\n      attributes.forEach(attr => {\n        if (attr.key && attr.value) {\n          if (!processed[attr.key]) {\n            processed[attr.key] = [];\n          }\n          processed[attr.key].push(attr.value);\n        }\n      });\n    } else if (typeof attributes === 'object') {\n      // If attributes is already a map\n      Object.entries(attributes).forEach(([key, value]) => {\n        if (Array.isArray(value)) {\n          processed[key] = value;\n        } else {\n          processed[key] = [value];\n        }\n      });\n    }\n    \n    return processed;\n  };\n\n  // ============================== AUTHORIZATION MANAGEMENT ==============================\n\n  const fetchResources = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/resources`, {\n        headers: await getAuthHeaders()\n      });\n      console.log('ðŸ” Raw resources data:', response.data);\n      console.log('ðŸ” First resource attributes:', response.data[0]?.attributes);\n      \n      // Process attributes for each resource\n      const processedResources = response.data.map(resource => ({\n        ...resource,\n        attributes: processResourceAttributes(resource.attributes)\n      }));\n      \n      console.log('ðŸ” Processed resources:', processedResources);\n      setResources(processedResources);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch resources');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchPolicies = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/policies`, {\n        headers: await getAuthHeaders()\n      });\n      setPolicies(response.data);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch policies');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createPolicy = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/policies`, policyForm, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'Policy created successfully');\n      setPolicyForm({\n        name: '',\n        description: '',\n        roleName: 'PROVIDER'\n      });\n      fetchPolicies();\n    } catch (error) {\n      showMessage('error', 'Failed to create policy: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchPermissions = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/permissions`, {\n        headers: await getAuthHeaders()\n      });\n      setPermissions(response.data);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch permissions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createPermission = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/permissions`, permissionForm, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'Permission created successfully');\n      setPermissionForm({\n        name: '',\n        description: '',\n        resourceId: '',\n        scopeIds: [],\n        policyIds: []\n      });\n      fetchPermissions();\n    } catch (error) {\n      showMessage('error', 'Failed to create permission: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ============================== GROUP MANAGEMENT ==============================\n\n  const fetchGroups = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/groups`, {\n        headers: await getAuthHeaders()\n      });\n      setGroups(response.data);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch groups');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createGroup = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/groups`, {\n        name: groupForm.name,\n        parentGroupId: groupForm.parentGroupId || null\n      }, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'Group created successfully');\n      setGroupForm({ name: '', parentGroupId: '' });\n      fetchGroups();\n    } catch (error) {\n      handleApiError(error, 'Failed to create group');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteGroup = async (groupId, groupName) => {\n    if (!window.confirm(`Are you sure you want to delete group \"${groupName}\"?`)) {\n      return;\n    }\n    setLoading(true);\n    try {\n      await axios.delete(`${API_BASE_URL}/groups/${groupId}`, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', 'Group deleted successfully');\n      fetchGroups();\n    } catch (error) {\n      handleApiError(error, 'Failed to delete group');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchGroupMembers = async (groupId) => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/groups/${groupId}/members`, {\n        headers: await getAuthHeaders()\n      });\n      setSelectedGroupMembers(prev => ({\n        ...prev,\n        [groupId]: response.data\n      }));\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch group members');\n    }\n  };\n\n  const addUserToGroup = async (userId, groupId) => {\n    setLoading(true);\n    try {\n      await axios.put(`${API_BASE_URL}/users/${userId}/groups/${groupId}`, {}, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', 'User added to group successfully');\n      fetchGroupMembers(groupId);\n      fetchUsers();\n    } catch (error) {\n      handleApiError(error, 'Failed to add user to group');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const removeUserFromGroup = async (userId, groupId) => {\n    setLoading(true);\n    try {\n      await axios.delete(`${API_BASE_URL}/users/${userId}/groups/${groupId}`, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', 'User removed from group successfully');\n      fetchGroupMembers(groupId);\n      fetchUsers();\n    } catch (error) {\n      handleApiError(error, 'Failed to remove user from group');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Helper function to flatten groups tree for display\n  const flattenGroups = (groups, level = 0) => {\n    let result = [];\n    groups.forEach(group => {\n      result.push({ ...group, level });\n      if (group.subGroups && group.subGroups.length > 0) {\n        result = result.concat(flattenGroups(group.subGroups, level + 1));\n      }\n    });\n    return result;\n  };\n\n  // ============================== FEATURE PERMISSIONS ==============================\n\n  const fetchFeatures = async () => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/features`, {\n        headers: await getAuthHeaders()\n      });\n      setFeatures(response.data.features || []);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch features');\n    }\n  };\n\n  const fetchFeaturePermissions = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(`${API_BASE_URL}/feature-permissions`, {\n        headers: await getAuthHeaders()\n      });\n      setFeaturePermissions(response.data || []);\n    } catch (error) {\n      handleApiError(error, 'Failed to fetch feature permissions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchMyFeaturePermissions = async () => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/my-feature-permissions`, {\n        headers: await getAuthHeaders()\n      });\n      setMyFeaturePermissions(response.data || []);\n    } catch (error) {\n      // Silently fail - user might not have permissions\n      setMyFeaturePermissions([]);\n    }\n  };\n\n  const saveFeaturePermission = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/feature-permissions`, featurePermissionForm, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', response.data.message || 'Feature permission saved successfully');\n      setFeaturePermissionForm({\n        featureName: '',\n        grantedToRole: '',\n        allowedRoles: [],\n        allowedCounties: [],\n        restrictToOwnCounty: false,\n        limitations: '',\n        enabled: true\n      });\n      setSelectedFeature(null);\n      fetchFeaturePermissions();\n    } catch (error) {\n      handleApiError(error, 'Failed to save feature permission');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteFeaturePermission = async (id) => {\n    if (!window.confirm('Are you sure you want to delete this feature permission?')) {\n      return;\n    }\n    setLoading(true);\n    try {\n      await axios.delete(`${API_BASE_URL}/feature-permissions/${id}`, {\n        headers: await getAuthHeaders()\n      });\n      showMessage('success', 'Feature permission deleted successfully');\n      fetchFeaturePermissions();\n    } catch (error) {\n      handleApiError(error, 'Failed to delete feature permission');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFeatureSelect = (featureName) => {\n    setSelectedFeature(featureName);\n    setFeaturePermissionForm(prev => ({\n      ...prev,\n      featureName: featureName\n    }));\n  };\n\n  // Load data based on active tab\n  useEffect(() => {\n    switch (activeTab) {\n      case 'users':\n        fetchUsers();\n        fetchRoles();\n        break;\n      case 'roles':\n        fetchRoles();\n        break;\n      case 'policies':\n        fetchPolicies();\n        fetchRoles();\n        break;\n      case 'permissions':\n        fetchPermissions();\n        fetchResources();\n        fetchPolicies();\n        break;\n      case 'resources':\n        fetchResources();\n        break;\n      case 'groups':\n        fetchGroups();\n        fetchUsers();\n        break;\n      case 'feature-permissions':\n        fetchFeatures();\n        fetchFeaturePermissions();\n        fetchRoles();\n        break;\n      default:\n        break;\n    }\n  }, [activeTab]);\n\n  // Fetch user's feature permissions on mount\n  useEffect(() => {\n    fetchMyFeaturePermissions();\n  }, []);\n\n  // ============================== RENDER ==============================\n\n  // Show loading state while auth is initializing\n  if (authLoading) {\n    return (\n      <div className=\"admin-container\">\n        <div style={{ textAlign: 'center', padding: '50px' }}>\n          <div className=\"spinner\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Check if user has ADMIN role OR has feature permissions\n  const isAdmin = user && user.roles && user.roles.includes('ADMIN');\n  const hasFeaturePermissions = myFeaturePermissions.length > 0;\n  \n  if (!user || (!isAdmin && !hasFeaturePermissions)) {\n    return (\n      <div className=\"admin-container\">\n        <div style={{ textAlign: 'center', padding: '50px' }}>\n          <h1>ðŸ”’ Access Denied</h1>\n          <p style={{ color: '#e74c3c', fontSize: '1.2rem', marginBottom: '20px' }}>\n            Administrator role or feature permissions required to access this page.\n          </p>\n          <p>\n            You need the <strong>ADMIN</strong> role or granted feature permissions to access the Keycloak Administration interface.\n          </p>\n          <div style={{ marginTop: '30px' }}>\n            <p><strong>Current user:</strong> {user?.username || 'Not logged in'}</p>\n            <p><strong>Current roles:</strong> {user?.roles?.join(', ') || 'None'}</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <h1 className=\"admin-title\">ðŸ” Keycloak Administration</h1>\n      <p className=\"admin-subtitle\">Manage users, roles, policies, and permissions without accessing Keycloak console</p>\n\n      {message.text && (\n        <div className={`message ${message.type}`}>\n          {message.text}\n        </div>\n      )}\n\n      <div className=\"tabs\">\n        {/* Show Users tab only if ADMIN or has CREATE_USER permission */}\n        {(isAdmin || myFeaturePermissions.some(p => p.featureName === 'CREATE_USER')) && (\n          <button\n            className={activeTab === 'users' ? 'tab active' : 'tab'}\n            onClick={() => setActiveTab('users')}\n          >\n            ðŸ‘¥ Users\n          </button>\n        )}\n        {/* Show other tabs only to ADMIN */}\n        {isAdmin && (\n          <>\n            <button\n              className={activeTab === 'roles' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('roles')}\n            >\n              ðŸ‘¤ Roles\n            </button>\n            <button\n              className={activeTab === 'policies' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('policies')}\n            >\n              ðŸ“‹ Policies\n            </button>\n            <button\n              className={activeTab === 'permissions' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('permissions')}\n            >\n              ðŸ”‘ Permissions\n            </button>\n            <button\n              className={activeTab === 'resources' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('resources')}\n            >\n              ðŸ“¦ Resources\n            </button>\n            <button\n              className={activeTab === 'groups' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('groups')}\n            >\n              ðŸ‘¥ Groups\n            </button>\n            <button\n              className={activeTab === 'feature-permissions' ? 'tab active' : 'tab'}\n              onClick={() => setActiveTab('feature-permissions')}\n            >\n              âš™ï¸ Feature Permissions\n            </button>\n          </>\n        )}\n      </div>\n\n      <div className=\"tab-content\">\n        {/* ============================== USERS TAB ============================== */}\n        {activeTab === 'users' && (() => {\n          // Get CREATE_USER permission for current user\n          const createUserPermission = (myFeaturePermissions || []).find(p => p.featureName === 'CREATE_USER');\n          \n          // Parse allowed roles and counties\n          let allowedRolesList = [];\n          let allowedCountiesList = [];\n          if (createUserPermission) {\n            try {\n              if (createUserPermission.allowedRoles) {\n                allowedRolesList = JSON.parse(createUserPermission.allowedRoles);\n              }\n            } catch (e) {\n              allowedRolesList = createUserPermission.allowedRoles ? createUserPermission.allowedRoles.split(',') : [];\n            }\n            try {\n              if (createUserPermission.allowedCounties) {\n                allowedCountiesList = JSON.parse(createUserPermission.allowedCounties);\n              }\n            } catch (e) {\n              allowedCountiesList = createUserPermission.allowedCounties ? createUserPermission.allowedCounties.split(',') : [];\n            }\n          }\n          \n          // Get user's counties from JWT (if restrictToOwnCounty is true)\n          const userCounties = user?.locations || [];\n          const restrictToOwnCounty = createUserPermission?.restrictToOwnCounty || false;\n          const effectiveAllowedCounties = restrictToOwnCounty ? userCounties : (allowedCountiesList.length > 0 ? allowedCountiesList : []);\n          \n          // Filter roles based on permission\n          // For non-admin users: Only show roles that are configured in the feature permission\n          // Create role objects from allowedRolesList if roles haven't been fetched yet\n          let availableRoles = [];\n          \n          if (isAdmin) {\n            // Admin sees all roles\n            availableRoles = roles.filter(role => \n              !role.name.startsWith('default-') && \n              !role.name.includes('uma_') && \n              !role.name.includes('offline_')\n            );\n          } else {\n            // Non-admin users: Only show roles from allowedRolesList\n            if (allowedRolesList.length > 0) {\n              // Try to find roles from the fetched roles list\n              availableRoles = roles.filter(role => \n                !role.name.startsWith('default-') && \n                !role.name.includes('uma_') && \n                !role.name.includes('offline_') &&\n                allowedRolesList.includes(role.name)\n              );\n              \n              // If roles haven't been fetched yet or some roles are missing, create placeholder objects\n              const fetchedRoleNames = availableRoles.map(r => r.name);\n              const missingRoles = allowedRolesList.filter(roleName => !fetchedRoleNames.includes(roleName));\n              \n              // Add placeholder role objects for roles that haven't been fetched\n              missingRoles.forEach(roleName => {\n                availableRoles.push({\n                  id: roleName, // Use role name as ID temporarily\n                  name: roleName,\n                  description: ''\n                });\n              });\n            } else {\n              // No allowed roles configured\n              availableRoles = [];\n            }\n          }\n          \n          // Debug logging\n          console.log('Role filtering debug:', {\n            isAdmin,\n            totalRoles: roles.length,\n            allowedRolesList,\n            availableRolesCount: availableRoles.length,\n            availableRoles: availableRoles.map(r => r.name)\n          });\n          \n          return (\n            <div>\n              {!isAdmin && createUserPermission && (\n                <div style={{ \n                  padding: '15px', \n                  backgroundColor: '#fff3cd', \n                  border: '1px solid #ffc107', \n                  borderRadius: '5px', \n                  marginBottom: '20px' \n                }}>\n                  <p style={{ margin: 0, fontWeight: 'bold' }}>âš ï¸ Limited Access</p>\n                  <p style={{ margin: '5px 0 0 0', fontSize: '0.9em' }}>\n                    You can only create users with the following restrictions:\n                  </p>\n                  <ul style={{ margin: '5px 0 0 20px', fontSize: '0.9em' }}>\n                    {allowedRolesList.length > 0 && (\n                      <li>Allowed Roles: {allowedRolesList.join(', ')}</li>\n                    )}\n                    {effectiveAllowedCounties.length > 0 && (\n                      <li>Allowed Counties: {effectiveAllowedCounties.join(', ')}</li>\n                    )}\n                    {restrictToOwnCounty && (\n                      <li>Restricted to your assigned counties only</li>\n                    )}\n                  </ul>\n                </div>\n              )}\n              \n              <h2>Create New User</h2>\n              <form onSubmit={createUser} className=\"admin-form\">\n                <div className=\"form-row\">\n                  <div className=\"form-group\">\n                    <label>Username *</label>\n                    <input\n                      type=\"text\"\n                      value={userForm.username}\n                      onChange={(e) => setUserForm({ ...userForm, username: e.target.value })}\n                      required\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Email *</label>\n                    <input\n                      type=\"email\"\n                      value={userForm.email}\n                      onChange={(e) => setUserForm({ ...userForm, email: e.target.value })}\n                      required\n                    />\n                  </div>\n                </div>\n                <div className=\"form-row\">\n                  <div className=\"form-group\">\n                    <label>First Name</label>\n                    <input\n                      type=\"text\"\n                      value={userForm.firstName}\n                      onChange={(e) => setUserForm({ ...userForm, firstName: e.target.value })}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Last Name</label>\n                    <input\n                      type=\"text\"\n                      value={userForm.lastName}\n                      onChange={(e) => setUserForm({ ...userForm, lastName: e.target.value })}\n                    />\n                  </div>\n                </div>\n                <div className=\"form-row\">\n                  <div className=\"form-group\">\n                    <label>Password *</label>\n                    <input\n                      type=\"password\"\n                      value={userForm.password}\n                      onChange={(e) => setUserForm({ ...userForm, password: e.target.value })}\n                      required\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Role *</label>\n                    <select\n                      value={userForm.role}\n                      onChange={(e) => setUserForm({ ...userForm, role: e.target.value })}\n                      required\n                      disabled={!isAdmin && availableRoles.length === 0}\n                    >\n                      <option value=\"\">Select a role</option>\n                      {availableRoles.length > 0 ? (\n                        availableRoles.map((role) => (\n                          <option key={role.id} value={role.name}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))\n                      ) : (\n                        <option value=\"\" disabled>\n                          {!isAdmin && allowedRolesList.length === 0 \n                            ? 'No roles configured. Please contact admin to configure allowed roles.' \n                            : 'Loading roles...'}\n                        </option>\n                      )}\n                    </select>\n                    {!isAdmin && (\n                      <small style={{ \n                        color: allowedRolesList.length > 0 ? '#666' : '#dc3545', \n                        display: 'block', \n                        marginTop: '5px' \n                      }}>\n                        {allowedRolesList.length > 0 \n                          ? `You can only create users with roles: ${allowedRolesList.join(', ')}`\n                          : 'âš ï¸ No roles are configured for your permission. Please contact an administrator.'}\n                      </small>\n                    )}\n                  </div>\n                </div>\n                {effectiveAllowedCounties.length > 0 && (\n                  <div className=\"form-row\">\n                    <div className=\"form-group\">\n                      <label>County *</label>\n                      <select\n                        value={userForm.countyCode}\n                        onChange={(e) => setUserForm({ ...userForm, countyCode: e.target.value })}\n                        required\n                      >\n                        <option value=\"\">Select a county</option>\n                        {effectiveAllowedCounties.map((county) => (\n                          <option key={county} value={county}>\n                            {county}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  </div>\n                )}\n                <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                  {loading ? 'Creating...' : 'Create User'}\n                </button>\n              </form>\n\n              {/* Only show existing users table to ADMIN */}\n              {isAdmin && (\n                <>\n                  <h2>Existing Users</h2>\n                  {loading ? (\n                    <p>Loading users...</p>\n                  ) : (\n                    <table className=\"data-table\">\n                      <thead>\n                        <tr>\n                          <th>Username</th>\n                          <th>Email</th>\n                          <th>First Name</th>\n                          <th>Last Name</th>\n                          <th>Enabled</th>\n                          <th>Actions</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {users.map((user) => (\n                          <tr key={user.id}>\n                            <td>{user.username}</td>\n                            <td>{user.email}</td>\n                            <td>{user.firstName || '-'}</td>\n                            <td>{user.lastName || '-'}</td>\n                            <td>{user.enabled ? 'âœ… Yes' : 'âŒ No'}</td>\n                            <td>\n                              <button\n                                onClick={() => deleteUser(user.id, user.username)}\n                                className=\"btn-danger-small\"\n                              >\n                                Delete\n                              </button>\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  )}\n                </>\n              )}\n            </div>\n          );\n        })()}\n\n        {/* ============================== ROLES TAB ============================== */}\n        {activeTab === 'roles' && (\n          <div>\n            <h2>Create New Role</h2>\n            <form onSubmit={createRole} className=\"admin-form\">\n              <div className=\"form-group\">\n                <label>Role Name *</label>\n                <input\n                  type=\"text\"\n                  value={roleForm.name}\n                  onChange={(e) => setRoleForm({ ...roleForm, name: e.target.value })}\n                  placeholder=\"e.g., MANAGER, SUPERVISOR\"\n                  required\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Description</label>\n                <input\n                  type=\"text\"\n                  value={roleForm.description}\n                  onChange={(e) => setRoleForm({ ...roleForm, description: e.target.value })}\n                  placeholder=\"e.g., Manager role with full access\"\n                />\n              </div>\n              <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                {loading ? 'Creating...' : 'Create Role'}\n              </button>\n            </form>\n\n            <h2>Existing Roles</h2>\n            {loading ? (\n              <p>Loading roles...</p>\n            ) : (\n              <table className=\"data-table\">\n                <thead>\n                  <tr>\n                    <th>Name</th>\n                    <th>Description</th>\n                    <th>Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {roles.filter(role => !role.name.startsWith('default-') && !role.name.includes('uma_') && !role.name.includes('offline_')).map((role) => (\n                    <tr key={role.id}>\n                      <td><strong>{role.name}</strong></td>\n                      <td>{role.description || '-'}</td>\n                      <td>\n                        <button\n                          onClick={() => deleteRole(role.id, role.name)}\n                          className=\"btn-danger-small\"\n                          title=\"Delete role\"\n                        >\n                          ðŸ—‘ï¸ Delete\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            )}\n          </div>\n        )}\n\n        {/* ============================== POLICIES TAB ============================== */}\n        {activeTab === 'policies' && (\n          <div>\n            <h2>Create New Policy</h2>\n            <form onSubmit={createPolicy} className=\"admin-form\">\n              <div className=\"form-group\">\n                <label>Policy Name *</label>\n                <input\n                  type=\"text\"\n                  value={policyForm.name}\n                  onChange={(e) => setPolicyForm({ ...policyForm, name: e.target.value })}\n                  placeholder=\"e.g., Recipient Read Policy\"\n                  required\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Description</label>\n                <input\n                  type=\"text\"\n                  value={policyForm.description}\n                  onChange={(e) => setPolicyForm({ ...policyForm, description: e.target.value })}\n                  placeholder=\"e.g., Allows recipients to read timesheets\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Role *</label>\n                <select\n                  value={policyForm.roleName}\n                  onChange={(e) => setPolicyForm({ ...policyForm, roleName: e.target.value })}\n                >\n                  {roles.filter(r => !r.name.startsWith('default-')).map((role) => (\n                    <option key={role.id} value={role.name}>\n                      {role.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                {loading ? 'Creating...' : 'Create Policy'}\n              </button>\n            </form>\n\n            <h2>Existing Policies</h2>\n            {loading ? (\n              <p>Loading policies...</p>\n            ) : (\n              <table className=\"data-table\">\n                <thead>\n                  <tr>\n                    <th>Name</th>\n                    <th>Type</th>\n                    <th>Description</th>\n                    <th>Logic</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {policies.map((policy) => (\n                    <tr key={policy.id}>\n                      <td>{policy.name}</td>\n                      <td>{policy.type}</td>\n                      <td>{policy.description || '-'}</td>\n                      <td>{policy.logic}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            )}\n          </div>\n        )}\n\n        {/* ============================== PERMISSIONS TAB ============================== */}\n        {activeTab === 'permissions' && (\n          <div>\n            <h2>Create New Permission</h2>\n            <form onSubmit={createPermission} className=\"admin-form\">\n              <div className=\"form-group\">\n                <label>Permission Name *</label>\n                <input\n                  type=\"text\"\n                  value={permissionForm.name}\n                  onChange={(e) => setPermissionForm({ ...permissionForm, name: e.target.value })}\n                  placeholder=\"e.g., Recipient Read Timesheets\"\n                  required\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Description</label>\n                <input\n                  type=\"text\"\n                  value={permissionForm.description}\n                  onChange={(e) => setPermissionForm({ ...permissionForm, description: e.target.value })}\n                  placeholder=\"e.g., Allows recipients to read timesheet data\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Resource *</label>\n                <select\n                  value={permissionForm.resourceId}\n                  onChange={(e) => setPermissionForm({ ...permissionForm, resourceId: e.target.value })}\n                  required\n                >\n                  <option value=\"\">Select a resource</option>\n                  {resources.map((resource) => (\n                    <option key={resource._id} value={resource._id}>\n                      {resource.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <div className=\"form-group\">\n                <label>Scopes * (comma-separated scope IDs)</label>\n                <input\n                  type=\"text\"\n                  value={permissionForm.scopeIds.join(',')}\n                  onChange={(e) => setPermissionForm({ \n                    ...permissionForm, \n                    scopeIds: e.target.value.split(',').map(s => s.trim()).filter(s => s) \n                  })}\n                  placeholder=\"e.g., scope-id-1, scope-id-2\"\n                  required\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Policies * (comma-separated policy IDs)</label>\n                <input\n                  type=\"text\"\n                  value={permissionForm.policyIds.join(',')}\n                  onChange={(e) => setPermissionForm({ \n                    ...permissionForm, \n                    policyIds: e.target.value.split(',').map(s => s.trim()).filter(s => s) \n                  })}\n                  placeholder=\"e.g., policy-id-1, policy-id-2\"\n                  required\n                />\n              </div>\n              <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                {loading ? 'Creating...' : 'Create Permission'}\n              </button>\n            </form>\n\n            <h2>Existing Permissions</h2>\n            {loading ? (\n              <p>Loading permissions...</p>\n            ) : (\n              <table className=\"data-table\">\n                <thead>\n                  <tr>\n                    <th>Name</th>\n                    <th>Type</th>\n                    <th>Description</th>\n                    <th>Decision Strategy</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {permissions.map((permission) => (\n                    <tr key={permission.id}>\n                      <td>{permission.name}</td>\n                      <td>{permission.type}</td>\n                      <td>{permission.description || '-'}</td>\n                      <td>{permission.decisionStrategy}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            )}\n          </div>\n        )}\n\n        {/* ============================== RESOURCES TAB ============================== */}\n        {activeTab === 'resources' && (\n          <div>\n            <h2>Resources & Attributes</h2>\n            {loading ? (\n              <p>Loading resources...</p>\n            ) : (\n              <div>\n                {resources.map((resource) => (\n                  <div key={resource._id} className=\"resource-card\">\n                    <h3>{resource.name}</h3>\n                    <p><strong>Type:</strong> {resource.type || '-'}</p>\n                    <p><strong>URIs:</strong> {resource.uris?.join(', ') || '-'}</p>\n                    \n                    {resource.scopes && resource.scopes.length > 0 && (\n                      <div style={{ marginTop: '10px' }}>\n                        <strong>Scopes:</strong>\n                        <ul>\n                          {resource.scopes.map((scope) => (\n                            <li key={scope.id}>{scope.name} (ID: {scope.id})</li>\n                          ))}\n                        </ul>\n                      </div>\n                    )}\n\n                    <div style={{ marginTop: '15px' }}>\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                        <strong>Attributes:</strong>\n                        <button\n                          onClick={() => {\n                            setEditingResource(resource._id);\n                            setAttributeForm({ key: '', value: '' });\n                          }}\n                          className=\"btn-primary-small\"\n                          style={{ fontSize: '12px', padding: '5px 10px' }}\n                        >\n                          âž• Add Attribute\n                        </button>\n                      </div>\n\n                      {editingResource === resource._id && (\n                        <div style={{ \n                          marginTop: '10px', \n                          padding: '15px', \n                          backgroundColor: '#f0f8ff',\n                          border: '1px solid #ccc',\n                          borderRadius: '5px'\n                        }}>\n                          <h4 style={{ marginTop: 0 }}>Add New Attribute</h4>\n                          <div style={{ display: 'flex', gap: '10px', alignItems: 'flex-end' }}>\n                            <div style={{ flex: 1 }}>\n                              <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                                Attribute Key *\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={attributeForm.key}\n                                onChange={(e) => setAttributeForm({ ...attributeForm, key: e.target.value })}\n                                placeholder=\"e.g., recipient_read_fields\"\n                                style={{ width: '100%', padding: '8px', border: '1px solid #ccc', borderRadius: '4px' }}\n                              />\n                            </div>\n                            <div style={{ flex: 1 }}>\n                              <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                                Attribute Value *\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={attributeForm.value}\n                                onChange={(e) => setAttributeForm({ ...attributeForm, value: e.target.value })}\n                                placeholder=\"e.g., id,date,hours\"\n                                style={{ width: '100%', padding: '8px', border: '1px solid #ccc', borderRadius: '4px' }}\n                              />\n                            </div>\n                            <button\n                              onClick={() => addResourceAttribute(resource._id, resource.name)}\n                              className=\"btn-primary\"\n                              disabled={loading || !attributeForm.key || !attributeForm.value}\n                              style={{ padding: '8px 15px' }}\n                            >\n                              Add\n                            </button>\n                            <button\n                              onClick={() => {\n                                setEditingResource(null);\n                                setAttributeForm({ key: '', value: '' });\n                              }}\n                              className=\"btn-secondary\"\n                              style={{ padding: '8px 15px' }}\n                            >\n                              Cancel\n                            </button>\n                          </div>\n                          <p style={{ fontSize: '12px', color: '#666', marginTop: '10px', marginBottom: 0 }}>\n                            ðŸ’¡ Tip: For field-level authorization, use format: <code>role_scope_fields</code> (e.g., recipient_read_fields)\n                          </p>\n                        </div>\n                      )}\n\n                      {resource.attributes && Object.keys(resource.attributes).length > 0 ? (\n                        <table style={{ \n                          width: '100%', \n                          marginTop: '10px', \n                          borderCollapse: 'collapse',\n                          fontSize: '14px'\n                        }}>\n                          <thead>\n                            <tr style={{ backgroundColor: '#f5f5f5' }}>\n                              <th style={{ \n                                padding: '10px', \n                                textAlign: 'left', \n                                borderBottom: '2px solid #ddd',\n                                width: '30%'\n                              }}>Key</th>\n                              <th style={{ \n                                padding: '10px', \n                                textAlign: 'left', \n                                borderBottom: '2px solid #ddd',\n                                width: '55%'\n                              }}>Value</th>\n                              <th style={{ \n                                padding: '10px', \n                                textAlign: 'center', \n                                borderBottom: '2px solid #ddd',\n                                width: '15%'\n                              }}>Actions</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {Object.entries(resource.attributes).map(([key, value]) => {\n                              const isEditing = editingAttribute?.resourceId === resource._id && editingAttribute?.oldKey === key;\n                              \n                              return (\n                                <tr key={key} style={{ borderBottom: '1px solid #eee' }}>\n                                  {isEditing ? (\n                                    <>\n                                      <td style={{ padding: '10px' }}>\n                                        <input\n                                          type=\"text\"\n                                          value={attributeEditForm.key}\n                                          onChange={(e) => setAttributeEditForm({ ...attributeEditForm, key: e.target.value })}\n                                          placeholder=\"Attribute key\"\n                                          style={{ width: '100%', padding: '5px' }}\n                                        />\n                                      </td>\n                                      <td style={{ padding: '10px' }}>\n                                        <input\n                                          type=\"text\"\n                                          value={attributeEditForm.value}\n                                          onChange={(e) => setAttributeEditForm({ ...attributeEditForm, value: e.target.value })}\n                                          placeholder=\"Attribute value\"\n                                          style={{ width: '100%', padding: '5px' }}\n                                        />\n                                      </td>\n                                      <td style={{ padding: '10px', textAlign: 'center' }}>\n                                        <button\n                                          onClick={() => updateResourceAttribute(resource._id, resource.name)}\n                                          className=\"btn-primary-small\"\n                                          style={{ \n                                            marginRight: '8px', \n                                            fontSize: '12px', \n                                            padding: '6px 12px',\n                                            backgroundColor: '#28a745',\n                                            color: 'white',\n                                            border: 'none',\n                                            borderRadius: '4px',\n                                            cursor: 'pointer'\n                                          }}\n                                          title=\"Save changes\"\n                                        >\n                                          âœ… Save\n                                        </button>\n                                        <button\n                                          onClick={cancelEditAttribute}\n                                          className=\"btn-secondary-small\"\n                                          style={{ \n                                            fontSize: '12px', \n                                            padding: '6px 12px',\n                                            backgroundColor: '#6c757d',\n                                            color: 'white',\n                                            border: 'none',\n                                            borderRadius: '4px',\n                                            cursor: 'pointer'\n                                          }}\n                                          title=\"Cancel editing\"\n                                        >\n                                          âŒ Cancel\n                                        </button>\n                                      </td>\n                                    </>\n                                  ) : (\n                                    <>\n                                      <td style={{ padding: '10px' }}>\n                                        <strong>{key}</strong>\n                                      </td>\n                                      <td style={{ padding: '10px', fontFamily: 'monospace', color: '#0066cc' }}>\n                                        {Array.isArray(value) ? value.join(', ') : value}\n                                      </td>\n                                      <td style={{ padding: '10px', textAlign: 'center' }}>\n                                        <button\n                                          onClick={() => startEditAttribute(resource._id, key, Array.isArray(value) ? value.join(', ') : value)}\n                                          className=\"btn-secondary-small\"\n                                          style={{ \n                                            marginRight: '8px', \n                                            fontSize: '12px', \n                                            padding: '6px 12px',\n                                            backgroundColor: '#6c757d',\n                                            color: 'white',\n                                            border: 'none',\n                                            borderRadius: '4px',\n                                            cursor: 'pointer'\n                                          }}\n                                          title=\"Edit attribute\"\n                                        >\n                                          âœï¸ Edit\n                                        </button>\n                                        <button\n                                          onClick={() => deleteResourceAttribute(resource._id, resource.name, key)}\n                                          className=\"btn-danger-small\"\n                                          style={{ \n                                            fontSize: '12px', \n                                            padding: '6px 12px',\n                                            backgroundColor: '#dc3545',\n                                            color: 'white',\n                                            border: 'none',\n                                            borderRadius: '4px',\n                                            cursor: 'pointer'\n                                          }}\n                                          title=\"Delete attribute\"\n                                        >\n                                          ðŸ—‘ï¸ Delete\n                                        </button>\n                                      </td>\n                                    </>\n                                  )}\n                                </tr>\n                              );\n                            })}\n                          </tbody>\n                        </table>\n                      ) : (\n                        <p style={{ \n                          color: '#666', \n                          fontStyle: 'italic', \n                          marginTop: '10px',\n                          padding: '10px',\n                          backgroundColor: '#f9f9f9',\n                          borderRadius: '4px'\n                        }}>\n                          No attributes defined. Click \"Add Attribute\" to add field-level authorization rules.\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* ============================== GROUPS TAB ============================== */}\n        {activeTab === 'groups' && (\n          <div>\n            <h2>Create New Group</h2>\n            <form onSubmit={createGroup} className=\"admin-form\">\n              <div className=\"form-group\">\n                <label>Group Name *</label>\n                <input\n                  type=\"text\"\n                  value={groupForm.name}\n                  onChange={(e) => setGroupForm({ ...groupForm, name: e.target.value })}\n                  placeholder=\"e.g., County-CTA\"\n                  required\n                />\n              </div>\n              <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                {loading ? 'Creating...' : 'Create Group'}\n              </button>\n            </form>\n\n            <h2>Existing Groups</h2>\n            {loading ? (\n              <p>Loading groups...</p>\n            ) : (\n              <div>\n                {groups.length === 0 ? (\n                  <p>No groups found. Create a group to get started.</p>\n                ) : (\n                  flattenGroups(groups).map((group) => (\n                    <div key={group.id} style={{\n                      marginBottom: '20px',\n                      padding: '15px',\n                      border: '1px solid #ddd',\n                      borderRadius: '5px',\n                      backgroundColor: '#f9f9f9',\n                      marginLeft: `${(group.level || 0) * 20}px`\n                    }}>\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                        <div>\n                          <h3 style={{ margin: '0 0 10px 0' }}>\n                            {group.name}\n                            {group.path && <span style={{ color: '#666', fontSize: '0.9em', marginLeft: '10px' }}>({group.path})</span>}\n                          </h3>\n                          {group.subGroups && group.subGroups.length > 0 && (\n                            <p style={{ color: '#666', fontSize: '0.9em', margin: 0 }}>\n                              {group.subGroups.length} sub-group{group.subGroups.length !== 1 ? 's' : ''}\n                            </p>\n                          )}\n                        </div>\n                        <div>\n                          <button\n                            onClick={() => {\n                              if (selectedGroupMembers[group.id]) {\n                                setSelectedGroupMembers(prev => {\n                                  const newState = { ...prev };\n                                  delete newState[group.id];\n                                  return newState;\n                                });\n                              } else {\n                                fetchGroupMembers(group.id);\n                              }\n                            }}\n                            className=\"btn-primary-small\"\n                            style={{ marginRight: '10px' }}\n                          >\n                            {selectedGroupMembers[group.id] ? 'ðŸ‘ï¸ Hide Members' : 'ðŸ‘¥ View Members'}\n                          </button>\n                          <button\n                            onClick={() => deleteGroup(group.id, group.name)}\n                            className=\"btn-danger-small\"\n                          >\n                            ðŸ—‘ï¸ Delete\n                          </button>\n                        </div>\n                      </div>\n\n                      {selectedGroupMembers[group.id] && (\n                        <div style={{ marginTop: '15px', padding: '15px', backgroundColor: 'white', borderRadius: '5px' }}>\n                          <h4 style={{ marginTop: 0 }}>Group Members ({selectedGroupMembers[group.id].length})</h4>\n                          {selectedGroupMembers[group.id].length === 0 ? (\n                            <p style={{ color: '#666', fontStyle: 'italic' }}>No members in this group.</p>\n                          ) : (\n                            <table className=\"data-table\" style={{ marginTop: '10px' }}>\n                              <thead>\n                                <tr>\n                                  <th>Username</th>\n                                  <th>Email</th>\n                                  <th>First Name</th>\n                                  <th>Last Name</th>\n                                  <th>Actions</th>\n                                </tr>\n                              </thead>\n                              <tbody>\n                                {selectedGroupMembers[group.id].map((member) => (\n                                  <tr key={member.id}>\n                                    <td>{member.username}</td>\n                                    <td>{member.email}</td>\n                                    <td>{member.firstName || '-'}</td>\n                                    <td>{member.lastName || '-'}</td>\n                                    <td>\n                                      <button\n                                        onClick={() => removeUserFromGroup(member.id, group.id)}\n                                        className=\"btn-danger-small\"\n                                      >\n                                        Remove\n                                      </button>\n                                    </td>\n                                  </tr>\n                                ))}\n                              </tbody>\n                            </table>\n                          )}\n                          <div style={{ marginTop: '15px', padding: '15px', backgroundColor: '#f0f8ff', borderRadius: '5px' }}>\n                            <h4 style={{ marginTop: 0 }}>Add User to Group</h4>\n                            <select\n                              onChange={(e) => {\n                                if (e.target.value) {\n                                  addUserToGroup(e.target.value, group.id);\n                                  e.target.value = '';\n                                }\n                              }}\n                              style={{ width: '100%', padding: '8px', marginTop: '10px' }}\n                            >\n                              <option value=\"\">Select a user to add...</option>\n                              {users\n                                .filter(user => !selectedGroupMembers[group.id]?.some(m => m.id === user.id))\n                                .map((user) => (\n                                  <option key={user.id} value={user.id}>\n                                    {user.username} ({user.email})\n                                  </option>\n                                ))}\n                            </select>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ))\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* ============================== FEATURE PERMISSIONS TAB ============================== */}\n        {activeTab === 'feature-permissions' && (\n          <div>\n            <h2>Available Features</h2>\n            <p style={{ color: '#666', marginBottom: '20px' }}>\n              Select a feature to grant it to a role with specific limitations\n            </p>\n            \n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '15px', marginBottom: '30px' }}>\n              {features.map((feature) => (\n                <div\n                  key={feature}\n                  onClick={() => handleFeatureSelect(feature)}\n                  style={{\n                    padding: '20px',\n                    border: `2px solid ${selectedFeature === feature ? '#007bff' : '#ddd'}`,\n                    borderRadius: '8px',\n                    backgroundColor: selectedFeature === feature ? '#e7f3ff' : '#f9f9f9',\n                    cursor: 'pointer',\n                    textAlign: 'center',\n                    transition: 'all 0.3s',\n                    boxShadow: selectedFeature === feature ? '0 4px 8px rgba(0,123,255,0.2)' : 'none'\n                  }}\n                >\n                  <h3 style={{ margin: '0 0 10px 0', color: selectedFeature === feature ? '#007bff' : '#333' }}>\n                    {feature.replace(/_/g, ' ')}\n                  </h3>\n                  <p style={{ margin: 0, fontSize: '0.9em', color: '#666' }}>\n                    {featurePermissions.filter(fp => fp.featureName === feature).length} permission(s) configured\n                  </p>\n                </div>\n              ))}\n            </div>\n\n            {selectedFeature && (\n              <div style={{ marginTop: '30px', padding: '20px', backgroundColor: '#f0f8ff', borderRadius: '8px', border: '1px solid #007bff' }}>\n                <h2>Grant \"{selectedFeature.replace(/_/g, ' ')}\" to Role</h2>\n                <form onSubmit={saveFeaturePermission} className=\"admin-form\">\n                  <div className=\"form-row\">\n                    <div className=\"form-group\">\n                      <label>Feature *</label>\n                      <input\n                        type=\"text\"\n                        value={selectedFeature}\n                        disabled\n                        style={{ backgroundColor: '#e9ecef' }}\n                      />\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Grant to Role *</label>\n                      <select\n                        value={featurePermissionForm.grantedToRole}\n                        onChange={(e) => setFeaturePermissionForm({ ...featurePermissionForm, grantedToRole: e.target.value })}\n                        required\n                      >\n                        <option value=\"\">Select a role</option>\n                        {roles.filter(role => !role.name.startsWith('default-') && !role.name.includes('uma_') && !role.name.includes('offline_')).map((role) => (\n                          <option key={role.id} value={role.name}>\n                            {role.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  </div>\n\n                  <div className=\"form-row\">\n                    <div className=\"form-group\">\n                      <label>Allowed Roles (for user creation features)</label>\n                      <select\n                        multiple\n                        value={featurePermissionForm.allowedRoles}\n                        onChange={(e) => {\n                          const selected = Array.from(e.target.selectedOptions, option => option.value);\n                          setFeaturePermissionForm({ ...featurePermissionForm, allowedRoles: selected });\n                        }}\n                        style={{ minHeight: '100px' }}\n                      >\n                        {roles.filter(role => !role.name.startsWith('default-') && !role.name.includes('uma_') && !role.name.includes('offline_')).map((role) => (\n                          <option key={role.id} value={role.name}>\n                            {role.name}\n                          </option>\n                        ))}\n                      </select>\n                      <small style={{ color: '#666' }}>Hold Ctrl/Cmd to select multiple roles</small>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Allowed Counties</label>\n                      <input\n                        type=\"text\"\n                        value={featurePermissionForm.allowedCounties.join(',')}\n                        onChange={(e) => setFeaturePermissionForm({\n                          ...featurePermissionForm,\n                          allowedCounties: e.target.value.split(',').map(c => c.trim()).filter(c => c)\n                        })}\n                        placeholder=\"e.g., CTA, CTB, CTC (comma-separated)\"\n                      />\n                      <small style={{ color: '#666' }}>Leave empty to allow all counties</small>\n                    </div>\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={featurePermissionForm.restrictToOwnCounty}\n                        onChange={(e) => setFeaturePermissionForm({ ...featurePermissionForm, restrictToOwnCounty: e.target.checked })}\n                      />\n                      Restrict to User's Own County Only\n                    </label>\n                    <small style={{ color: '#666' }}>\n                      If checked, users can only access resources from their assigned county\n                    </small>\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>Additional Limitations (JSON)</label>\n                    <textarea\n                      value={featurePermissionForm.limitations}\n                      onChange={(e) => setFeaturePermissionForm({ ...featurePermissionForm, limitations: e.target.value })}\n                      placeholder='{\"maxUsersPerDay\": 10, \"requireApproval\": true}'\n                      rows={3}\n                    />\n                    <small style={{ color: '#666' }}>Optional: JSON object for feature-specific limitations</small>\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={featurePermissionForm.enabled}\n                        onChange={(e) => setFeaturePermissionForm({ ...featurePermissionForm, enabled: e.target.checked })}\n                      />\n                      Enabled\n                    </label>\n                  </div>\n\n                  <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                    {loading ? 'Saving...' : 'Save Permission'}\n                  </button>\n                </form>\n              </div>\n            )}\n\n            <h2 style={{ marginTop: '40px' }}>Existing Feature Permissions</h2>\n            {loading ? (\n              <p>Loading permissions...</p>\n            ) : (\n              <div>\n                {featurePermissions.length === 0 ? (\n                  <p>No feature permissions configured. Select a feature above to grant permissions.</p>\n                ) : (\n                  <table className=\"data-table\">\n                    <thead>\n                      <tr>\n                        <th>Feature</th>\n                        <th>Granted To Role</th>\n                        <th>Allowed Roles</th>\n                        <th>Allowed Counties</th>\n                        <th>Restrict to Own County</th>\n                        <th>Enabled</th>\n                        <th>Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {featurePermissions.map((permission) => {\n                        let allowedRolesList = [];\n                        let allowedCountiesList = [];\n                        try {\n                          if (permission.allowedRoles) {\n                            allowedRolesList = JSON.parse(permission.allowedRoles);\n                          }\n                        } catch (e) {\n                          allowedRolesList = permission.allowedRoles ? permission.allowedRoles.split(',') : [];\n                        }\n                        try {\n                          if (permission.allowedCounties) {\n                            allowedCountiesList = JSON.parse(permission.allowedCounties);\n                          }\n                        } catch (e) {\n                          allowedCountiesList = permission.allowedCounties ? permission.allowedCounties.split(',') : [];\n                        }\n                        \n                        return (\n                          <tr key={permission.id}>\n                            <td><strong>{permission.featureName.replace(/_/g, ' ')}</strong></td>\n                            <td>{permission.grantedToRole}</td>\n                            <td>{allowedRolesList.length > 0 ? allowedRolesList.join(', ') : 'All'}</td>\n                            <td>{allowedCountiesList.length > 0 ? allowedCountiesList.join(', ') : 'All'}</td>\n                            <td>{permission.restrictToOwnCounty ? 'âœ… Yes' : 'âŒ No'}</td>\n                            <td>{permission.enabled ? 'âœ… Yes' : 'âŒ No'}</td>\n                            <td>\n                              <button\n                                onClick={() => deleteFeaturePermission(permission.id)}\n                                className=\"btn-danger-small\"\n                              >\n                                ðŸ—‘ï¸ Delete\n                              </button>\n                            </td>\n                          </tr>\n                        );\n                      })}\n                    </tbody>\n                  </table>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default KeycloakAdminDashboard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}