{"ast":null,"code":"import _objectSpread from\"/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import{useNavigate}from'react-router-dom';import{apiClient}from'../config/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TimesheetManagement=()=>{const{user,loading:authLoading}=useAuth();const navigate=useNavigate();const[timesheets,setTimesheets]=useState([]);const[availableFields,setAvailableFields]=useState([]);const[allowedActions,setAllowedActions]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[success,setSuccess]=useState('');const[showForm,setShowForm]=useState(false);const[editingTimesheet,setEditingTimesheet]=useState(null);const[formData,setFormData]=useState({payPeriodStart:'',payPeriodEnd:'',regularHours:'',overtimeHours:'',department:'',location:'',comments:''});useEffect(()=>{if(authLoading)return;// Wait for auth to initialize\nif(!user){navigate('/login');return;}fetchTimesheets();},[user,navigate,authLoading]);const fetchTimesheets=async()=>{try{setLoading(true);setError('');const response=await apiClient.get('/timesheets');// Handle paginated response from backend\nconst timesheets=response.data.content||response.data;const actions=response.data.allowedActions||[];setTimesheets(timesheets);setAllowedActions(actions);// Extract available fields dynamically from the first timesheet\nif(timesheets.length>0){const fields=Object.keys(timesheets[0]);setAvailableFields(fields);console.log('Available fields from backend:',fields);}console.log('Allowed actions from backend:',actions);console.log('Actions length:',actions.length);console.log('Actions type:',typeof actions);// Debug: Show which buttons will be displayed\nif(actions.length>0){console.log('âœ… Actions found - Buttons that will show:');actions.forEach(action=>console.log(\"  - \".concat(action,\" button\")));}else{console.log('âŒ No actions found - No action buttons will show');console.log('ðŸ’¡ Add provider_actions attribute in Keycloak to show buttons');}}catch(err){var _err$response,_err$response2;console.error('Error fetching timesheets:',err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===403){setError('Access denied: You do not have permission to view timesheets');}else if(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setError('Authentication failed. Please login again.');}else{setError('Failed to fetch timesheets. Please try again.');}}finally{setLoading(false);}};const handleSubmit=async e=>{e.preventDefault();setError('');setSuccess('');// Validation\nif(!formData.payPeriodStart||!formData.payPeriodEnd){setError('Please enter both start and end dates');return;}if(!formData.regularHours||parseFloat(formData.regularHours)<=0){setError('Please enter regular hours (must be greater than 0)');return;}if(!formData.department||!formData.location){setError('Please enter department and location');return;}try{const timesheetData={employeeId:(user===null||user===void 0?void 0:user.userId)||(user===null||user===void 0?void 0:user.username),employeeName:(user===null||user===void 0?void 0:user.username)||'Unknown',payPeriodStart:formData.payPeriodStart,payPeriodEnd:formData.payPeriodEnd,regularHours:parseFloat(formData.regularHours)||0,overtimeHours:parseFloat(formData.overtimeHours)||0,holidayHours:0,sickHours:0,vacationHours:0,department:formData.department,location:formData.location,comments:formData.comments||''};if(editingTimesheet){// Get the timesheet ID using our helper function\nconst timesheetId=await getTimesheetId(editingTimesheet);if(timesheetId){await apiClient.put(\"/timesheets/\".concat(timesheetId),timesheetData);setSuccess('Timesheet updated successfully!');}else{// If we can't find the ID, show an error with helpful message\nsetError('Cannot edit timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');return;}}else{await apiClient.post('/timesheets',timesheetData);setSuccess('Timesheet created successfully!');}setShowForm(false);setEditingTimesheet(null);setFormData({payPeriodStart:'',payPeriodEnd:'',regularHours:'',overtimeHours:'',department:'',location:'',comments:''});fetchTimesheets();}catch(err){var _err$response3,_err$response6;console.error('Error saving timesheet:',err);// Better error handling\nif(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===400){var _err$response4,_err$response4$data,_err$response5;if((_err$response4=err.response)!==null&&_err$response4!==void 0&&(_err$response4$data=_err$response4.data)!==null&&_err$response4$data!==void 0&&_err$response4$data.message){setError(err.response.data.message);}else if(typeof((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.data)==='string'&&err.response.data.includes('already exists')){setError('A timesheet already exists for this pay period. Please choose different dates or edit the existing timesheet.');}else{setError('Invalid data. Please check all fields and try again.');}}else if(((_err$response6=err.response)===null||_err$response6===void 0?void 0:_err$response6.status)===403){setError('You do not have permission to create timesheets.');}else{setError('Failed to save timesheet. Please try again.');}}};const handleEdit=timesheet=>{var _timesheet$regularHou,_timesheet$overtimeHo;setEditingTimesheet(timesheet);setFormData({payPeriodStart:timesheet.payPeriodStart||'',payPeriodEnd:timesheet.payPeriodEnd||'',regularHours:((_timesheet$regularHou=timesheet.regularHours)===null||_timesheet$regularHou===void 0?void 0:_timesheet$regularHou.toString())||'',overtimeHours:((_timesheet$overtimeHo=timesheet.overtimeHours)===null||_timesheet$overtimeHo===void 0?void 0:_timesheet$overtimeHo.toString())||'',department:timesheet.department||'',location:timesheet.location||'',comments:timesheet.comments||''});setShowForm(true);};const handleDelete=async timesheet=>{if(window.confirm('Are you sure you want to delete this timesheet?')){try{const timesheetId=await getTimesheetId(timesheet);if(timesheetId){// Send delete request with optional request body for field filtering\nconst deleteData={reason:\"Deleted by user\"};await apiClient.delete(\"/timesheets/\".concat(timesheetId),{data:deleteData});setSuccess('Timesheet deleted successfully!');fetchTimesheets();}else{setError('Cannot delete timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');}}catch(err){var _err$response7,_err$response8;console.error('Error deleting timesheet:',err);if(((_err$response7=err.response)===null||_err$response7===void 0?void 0:_err$response7.status)===403){setError('Access denied: You do not have permission to delete timesheets');}else if(((_err$response8=err.response)===null||_err$response8===void 0?void 0:_err$response8.status)===400){var _err$response9,_err$response9$data;setError(((_err$response9=err.response)===null||_err$response9===void 0?void 0:(_err$response9$data=_err$response9.data)===null||_err$response9$data===void 0?void 0:_err$response9$data.message)||'Cannot delete this timesheet');}else{setError('Failed to delete timesheet');}}}};const handleApprove=async timesheet=>{try{const timesheetId=await getTimesheetId(timesheet);if(timesheetId){// Send approve request with supervisor comments\nconst approveData={supervisorComments:\"Approved by supervisor\"};const response=await apiClient.post(\"/timesheets/\".concat(timesheetId,\"/approve\"),approveData);setSuccess('Timesheet approved successfully!');fetchTimesheets();}else{setError('Cannot approve timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');}}catch(err){var _err$response0;console.error('Error approving timesheet:',err);if(((_err$response0=err.response)===null||_err$response0===void 0?void 0:_err$response0.status)===403){setError('Access denied: You do not have permission to approve timesheets');}else{var _err$response1,_err$response1$data;setError(((_err$response1=err.response)===null||_err$response1===void 0?void 0:(_err$response1$data=_err$response1.data)===null||_err$response1$data===void 0?void 0:_err$response1$data.message)||'Failed to approve timesheet. Please try again.');}}};const handleReject=async timesheet=>{const reason=prompt('Please enter rejection reason:');if(reason){try{const timesheetId=await getTimesheetId(timesheet);if(timesheetId){// Send reject request with supervisor comments\nconst rejectData={supervisorComments:reason};const response=await apiClient.post(\"/timesheets/\".concat(timesheetId,\"/reject\"),rejectData);setSuccess('Timesheet rejected successfully!');fetchTimesheets();}else{setError('Cannot reject timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');}}catch(err){var _err$response10;console.error('Error rejecting timesheet:',err);if(((_err$response10=err.response)===null||_err$response10===void 0?void 0:_err$response10.status)===403){setError('Access denied: You do not have permission to reject timesheets');}else{var _err$response11,_err$response11$data;setError(((_err$response11=err.response)===null||_err$response11===void 0?void 0:(_err$response11$data=_err$response11.data)===null||_err$response11$data===void 0?void 0:_err$response11$data.message)||'Failed to reject timesheet. Please try again.');}}}};const getStatusBadge=status=>{const badges={DRAFT:'badge-secondary',SUBMITTED:'badge-primary',APPROVED:'badge-success',REJECTED:'badge-danger',REVISION_REQUESTED:'badge-warning'};return badges[status]||'badge-secondary';};// Helper function to get user-friendly field names\nconst getFieldDisplayName=fieldName=>{const fieldNames={'id':'ID','userId':'User ID','employeeName':'Employee Name','department':'Department','location':'Location','payPeriodStart':'Pay Period Start','payPeriodEnd':'Pay Period End','regularHours':'Regular Hours','overtimeHours':'Overtime Hours','holidayHours':'Holiday Hours','sickHours':'Sick Hours','vacationHours':'Vacation Hours','totalHours':'Total Hours','status':'Status','comments':'Comments','supervisorComments':'Supervisor Comments','approvedBy':'Approved By','approvedAt':'Approved At','submittedBy':'Submitted By','submittedAt':'Submitted At','createdAt':'Created At','updatedAt':'Updated At'};return fieldNames[fieldName]||fieldName.charAt(0).toUpperCase()+fieldName.slice(1);};// Helper function to format field values\nconst formatFieldValue=(fieldName,value)=>{if(value===null||value===undefined||value===''){return/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 italic\",children:\"Not accessible\"});}if(fieldName==='status'){return/*#__PURE__*/_jsx(\"span\",{className:\"badge \".concat(getStatusBadge(value)),children:value});}if(fieldName.includes('Hours')&&typeof value==='number'){return value.toFixed(2);}if(fieldName.includes('Date')||fieldName.includes('At')){return new Date(value).toLocaleDateString();}return value;};// Helper function to determine if a field should be shown in the table\nconst shouldShowField=fieldName=>{// Always show these fields\nconst alwaysShow=['status'];if(alwaysShow.includes(fieldName))return true;// Hide internal/system fields\nconst hideFields=['id','userId','createdAt','updatedAt'];if(hideFields.includes(fieldName))return false;// Show all other fields that are available\nreturn true;};// Helper function to get timesheet ID (since it might be filtered out)\nconst getTimesheetId=async timesheet=>{// If ID is available, use it\nif(timesheet.id){return timesheet.id;}// If ID is not available, we need to find it by matching other fields\n// This is a fallback when the ID field is filtered out by Keycloak\ntry{// Get all timesheets with full data to find the matching ID\nconst response=await apiClient.get('/timesheets');const allTimesheets=response.data.content||response.data;// Find matching timesheet by comparing available fields\nconst matchingTimesheet=allTimesheets.find(t=>t.employeeName===timesheet.employeeName&&t.location===timesheet.location&&t.overtimeHours===timesheet.overtimeHours);return(matchingTimesheet===null||matchingTimesheet===void 0?void 0:matchingTimesheet.id)||null;}catch(error){console.error('Error getting timesheet ID:',error);return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-ca-secondary-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ca-header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ca-logo\",children:\"CA\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-ca-primary-900\",children:\"Timesheet Management\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-ca-primary-700\",children:[user===null||user===void 0?void 0:user.username,\" (\",user===null||user===void 0?void 0:user.role,\")\"]}),allowedActions.length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded\",children:[\"Actions: \",allowedActions.join(', ')]}),allowedActions.length===0&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-red-100 text-red-800 px-2 py-1 rounded\",children:\"No actions configured\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"btn btn-outline\",children:\"Back to Dashboard\"})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container py-8\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-error mb-4\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success mb-4\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-ca-primary-900\",children:\"My Timesheets\"}),allowedActions.includes('create')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(showForm){setShowForm(false);setEditingTimesheet(null);}else{setShowForm(true);setEditingTimesheet(null);setError('');setSuccess('');}},className:\"btn btn-primary\",children:showForm?'Cancel':'+ New Timesheet'})]}),showForm&&/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-ca-primary-900\",children:editingTimesheet?'Edit Timesheet':'Create New Timesheet'})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Pay Period Start Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",required:true,className:\"input\",value:formData.payPeriodStart,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{payPeriodStart:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Pay Period End Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",required:true,className:\"input\",value:formData.payPeriodEnd,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{payPeriodEnd:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Regular Hours\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.5\",className:\"input\",placeholder:\"e.g., 40\",value:formData.regularHours,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{regularHours:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Overtime Hours\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.5\",className:\"input\",placeholder:\"e.g., 5\",value:formData.overtimeHours,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{overtimeHours:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Department *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,className:\"input\",placeholder:\"e.g., IT\",value:formData.department,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{department:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Location *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,className:\"input\",placeholder:\"e.g., Sacramento\",value:formData.location,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{location:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Comments\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"input\",rows:\"3\",placeholder:\"Additional notes...\",value:formData.comments,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{comments:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowForm(false);setEditingTimesheet(null);setFormData({startDate:'',endDate:'',hoursWorked:'',department:'',location:'',comments:''});},className:\"btn btn-secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:[editingTimesheet?'Update':'Create',\" Timesheet\"]})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-ca-primary-900\",children:\"Timesheets\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-ca-highlight-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-ca-primary-600\",children:\"Loading timesheets...\"})]}):timesheets.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-ca-primary-600\",children:\"No timesheets found. Create your first timesheet!\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[availableFields.filter(shouldShowField).map(fieldName=>/*#__PURE__*/_jsx(\"th\",{children:getFieldDisplayName(fieldName)},fieldName)),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:timesheets.map(timesheet=>/*#__PURE__*/_jsxs(\"tr\",{children:[availableFields.filter(shouldShowField).map(fieldName=>/*#__PURE__*/_jsx(\"td\",{children:formatFieldValue(fieldName,timesheet[fieldName])},fieldName)),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[allowedActions.includes('edit')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(timesheet),className:\"btn btn-sm btn-secondary\",title:\"Edit this timesheet\",children:\"Edit\"}),allowedActions.includes('delete')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(timesheet),className:\"btn btn-sm btn-danger\",title:\"Delete this timesheet\",children:\"Delete\"}),allowedActions.includes('approve')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleApprove(timesheet),className:\"btn btn-sm btn-success\",title:\"Approve this timesheet\",children:\"Approve\"}),allowedActions.includes('reject')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReject(timesheet),className:\"btn btn-sm btn-danger\",title:\"Reject this timesheet\",children:\"Reject\"}),allowedActions.length===0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-400 italic text-sm\",children:[\"No actions available\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"(Add provider_actions in Keycloak)\"})]}),allowedActions.length>0&&!timesheet.id&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-yellow-600 italic text-sm\",children:[\"Actions available but ID missing\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"(Add \\\"id\\\" to provider_read_fields in Keycloak)\"})]})]})})]},timesheet.id))})]})})})]})]})]});};export default TimesheetManagement;","map":{"version":3,"names":["React","useState","useEffect","useAuth","useNavigate","apiClient","jsx","_jsx","jsxs","_jsxs","TimesheetManagement","user","loading","authLoading","navigate","timesheets","setTimesheets","availableFields","setAvailableFields","allowedActions","setAllowedActions","setLoading","error","setError","success","setSuccess","showForm","setShowForm","editingTimesheet","setEditingTimesheet","formData","setFormData","payPeriodStart","payPeriodEnd","regularHours","overtimeHours","department","location","comments","fetchTimesheets","response","get","data","content","actions","length","fields","Object","keys","console","log","forEach","action","concat","err","_err$response","_err$response2","status","handleSubmit","e","preventDefault","parseFloat","timesheetData","employeeId","userId","username","employeeName","holidayHours","sickHours","vacationHours","timesheetId","getTimesheetId","put","post","_err$response3","_err$response6","_err$response4","_err$response4$data","_err$response5","message","includes","handleEdit","timesheet","_timesheet$regularHou","_timesheet$overtimeHo","toString","handleDelete","window","confirm","deleteData","reason","delete","_err$response7","_err$response8","_err$response9","_err$response9$data","handleApprove","approveData","supervisorComments","_err$response0","_err$response1","_err$response1$data","handleReject","prompt","rejectData","_err$response10","_err$response11","_err$response11$data","getStatusBadge","badges","DRAFT","SUBMITTED","APPROVED","REJECTED","REVISION_REQUESTED","getFieldDisplayName","fieldName","fieldNames","charAt","toUpperCase","slice","formatFieldValue","value","undefined","className","children","toFixed","Date","toLocaleDateString","shouldShowField","alwaysShow","hideFields","id","allTimesheets","matchingTimesheet","find","t","role","join","onClick","onSubmit","type","required","onChange","_objectSpread","target","min","step","placeholder","rows","startDate","endDate","hoursWorked","filter","map","title"],"sources":["/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/src/components/TimesheetManagement.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { apiClient } from '../config/api';\n\nconst TimesheetManagement = () => {\n  const { user, loading: authLoading } = useAuth();\n  const navigate = useNavigate();\n  const [timesheets, setTimesheets] = useState([]);\n  const [availableFields, setAvailableFields] = useState([]);\n  const [allowedActions, setAllowedActions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const [showForm, setShowForm] = useState(false);\n  const [editingTimesheet, setEditingTimesheet] = useState(null);\n  const [formData, setFormData] = useState({\n    payPeriodStart: '',\n    payPeriodEnd: '',\n    regularHours: '',\n    overtimeHours: '',\n    department: '',\n    location: '',\n    comments: ''\n  });\n\n  useEffect(() => {\n    if (authLoading) return; // Wait for auth to initialize\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n    fetchTimesheets();\n  }, [user, navigate, authLoading]);\n\n  const fetchTimesheets = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const response = await apiClient.get('/timesheets');\n      // Handle paginated response from backend\n      const timesheets = response.data.content || response.data;\n      const actions = response.data.allowedActions || [];\n      \n      setTimesheets(timesheets);\n      setAllowedActions(actions);\n      \n      // Extract available fields dynamically from the first timesheet\n      if (timesheets.length > 0) {\n        const fields = Object.keys(timesheets[0]);\n        setAvailableFields(fields);\n        console.log('Available fields from backend:', fields);\n      }\n      \n      console.log('Allowed actions from backend:', actions);\n      console.log('Actions length:', actions.length);\n      console.log('Actions type:', typeof actions);\n      \n      // Debug: Show which buttons will be displayed\n      if (actions.length > 0) {\n        console.log('âœ… Actions found - Buttons that will show:');\n        actions.forEach(action => console.log(`  - ${action} button`));\n      } else {\n        console.log('âŒ No actions found - No action buttons will show');\n        console.log('ðŸ’¡ Add provider_actions attribute in Keycloak to show buttons');\n      }\n    } catch (err) {\n      console.error('Error fetching timesheets:', err);\n      if (err.response?.status === 403) {\n        setError('Access denied: You do not have permission to view timesheets');\n      } else if (err.response?.status === 401) {\n        setError('Authentication failed. Please login again.');\n      } else {\n        setError('Failed to fetch timesheets. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setSuccess('');\n    \n    // Validation\n    if (!formData.payPeriodStart || !formData.payPeriodEnd) {\n      setError('Please enter both start and end dates');\n      return;\n    }\n    \n    if (!formData.regularHours || parseFloat(formData.regularHours) <= 0) {\n      setError('Please enter regular hours (must be greater than 0)');\n      return;\n    }\n    \n    if (!formData.department || !formData.location) {\n      setError('Please enter department and location');\n      return;\n    }\n    \n    try {\n      const timesheetData = {\n        employeeId: user?.userId || user?.username,\n        employeeName: user?.username || 'Unknown',\n        payPeriodStart: formData.payPeriodStart,\n        payPeriodEnd: formData.payPeriodEnd,\n        regularHours: parseFloat(formData.regularHours) || 0,\n        overtimeHours: parseFloat(formData.overtimeHours) || 0,\n        holidayHours: 0,\n        sickHours: 0,\n        vacationHours: 0,\n        department: formData.department,\n        location: formData.location,\n        comments: formData.comments || ''\n      };\n\n      if (editingTimesheet) {\n        // Get the timesheet ID using our helper function\n        const timesheetId = await getTimesheetId(editingTimesheet);\n        \n        if (timesheetId) {\n          await apiClient.put(`/timesheets/${timesheetId}`, timesheetData);\n          setSuccess('Timesheet updated successfully!');\n        } else {\n          // If we can't find the ID, show an error with helpful message\n          setError('Cannot edit timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');\n          return;\n        }\n      } else {\n        await apiClient.post('/timesheets', timesheetData);\n        setSuccess('Timesheet created successfully!');\n      }\n\n      setShowForm(false);\n      setEditingTimesheet(null);\n      setFormData({\n        payPeriodStart: '',\n        payPeriodEnd: '',\n        regularHours: '',\n        overtimeHours: '',\n        department: '',\n        location: '',\n        comments: ''\n      });\n      fetchTimesheets();\n    } catch (err) {\n      console.error('Error saving timesheet:', err);\n      \n      // Better error handling\n      if (err.response?.status === 400) {\n        if (err.response?.data?.message) {\n          setError(err.response.data.message);\n        } else if (typeof err.response?.data === 'string' && err.response.data.includes('already exists')) {\n          setError('A timesheet already exists for this pay period. Please choose different dates or edit the existing timesheet.');\n        } else {\n          setError('Invalid data. Please check all fields and try again.');\n        }\n      } else if (err.response?.status === 403) {\n        setError('You do not have permission to create timesheets.');\n      } else {\n        setError('Failed to save timesheet. Please try again.');\n      }\n    }\n  };\n\n  const handleEdit = (timesheet) => {\n    setEditingTimesheet(timesheet);\n    setFormData({\n      payPeriodStart: timesheet.payPeriodStart || '',\n      payPeriodEnd: timesheet.payPeriodEnd || '',\n      regularHours: timesheet.regularHours?.toString() || '',\n      overtimeHours: timesheet.overtimeHours?.toString() || '',\n      department: timesheet.department || '',\n      location: timesheet.location || '',\n      comments: timesheet.comments || ''\n    });\n    setShowForm(true);\n  };\n\n  const handleDelete = async (timesheet) => {\n    if (window.confirm('Are you sure you want to delete this timesheet?')) {\n      try {\n        const timesheetId = await getTimesheetId(timesheet);\n        if (timesheetId) {\n          // Send delete request with optional request body for field filtering\n          const deleteData = {\n            reason: \"Deleted by user\"\n          };\n          \n          await apiClient.delete(`/timesheets/${timesheetId}`, { data: deleteData });\n          setSuccess('Timesheet deleted successfully!');\n          fetchTimesheets();\n        } else {\n          setError('Cannot delete timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');\n        }\n      } catch (err) {\n        console.error('Error deleting timesheet:', err);\n        if (err.response?.status === 403) {\n          setError('Access denied: You do not have permission to delete timesheets');\n        } else if (err.response?.status === 400) {\n          setError(err.response?.data?.message || 'Cannot delete this timesheet');\n        } else {\n          setError('Failed to delete timesheet');\n        }\n      }\n    }\n  };\n\n  const handleApprove = async (timesheet) => {\n    try {\n      const timesheetId = await getTimesheetId(timesheet);\n      if (timesheetId) {\n        // Send approve request with supervisor comments\n        const approveData = {\n          supervisorComments: \"Approved by supervisor\"\n        };\n        \n        const response = await apiClient.post(`/timesheets/${timesheetId}/approve`, approveData);\n        setSuccess('Timesheet approved successfully!');\n        fetchTimesheets();\n      } else {\n        setError('Cannot approve timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');\n      }\n    } catch (err) {\n      console.error('Error approving timesheet:', err);\n      if (err.response?.status === 403) {\n        setError('Access denied: You do not have permission to approve timesheets');\n      } else {\n        setError(err.response?.data?.message || 'Failed to approve timesheet. Please try again.');\n      }\n    }\n  };\n\n  const handleReject = async (timesheet) => {\n    const reason = prompt('Please enter rejection reason:');\n    if (reason) {\n      try {\n        const timesheetId = await getTimesheetId(timesheet);\n        if (timesheetId) {\n          // Send reject request with supervisor comments\n          const rejectData = {\n            supervisorComments: reason\n          };\n          \n          const response = await apiClient.post(`/timesheets/${timesheetId}/reject`, rejectData);\n          setSuccess('Timesheet rejected successfully!');\n          fetchTimesheets();\n        } else {\n          setError('Cannot reject timesheet: ID not available. Please add \"id\" to your Keycloak provider_read_fields configuration.');\n        }\n      } catch (err) {\n        console.error('Error rejecting timesheet:', err);\n        if (err.response?.status === 403) {\n          setError('Access denied: You do not have permission to reject timesheets');\n        } else {\n          setError(err.response?.data?.message || 'Failed to reject timesheet. Please try again.');\n        }\n      }\n    }\n  };\n\n  const getStatusBadge = (status) => {\n    const badges = {\n      DRAFT: 'badge-secondary',\n      SUBMITTED: 'badge-primary',\n      APPROVED: 'badge-success',\n      REJECTED: 'badge-danger',\n      REVISION_REQUESTED: 'badge-warning'\n    };\n    return badges[status] || 'badge-secondary';\n  };\n\n  // Helper function to get user-friendly field names\n  const getFieldDisplayName = (fieldName) => {\n    const fieldNames = {\n      'id': 'ID',\n      'userId': 'User ID',\n      'employeeName': 'Employee Name',\n      'department': 'Department',\n      'location': 'Location',\n      'payPeriodStart': 'Pay Period Start',\n      'payPeriodEnd': 'Pay Period End',\n      'regularHours': 'Regular Hours',\n      'overtimeHours': 'Overtime Hours',\n      'holidayHours': 'Holiday Hours',\n      'sickHours': 'Sick Hours',\n      'vacationHours': 'Vacation Hours',\n      'totalHours': 'Total Hours',\n      'status': 'Status',\n      'comments': 'Comments',\n      'supervisorComments': 'Supervisor Comments',\n      'approvedBy': 'Approved By',\n      'approvedAt': 'Approved At',\n      'submittedBy': 'Submitted By',\n      'submittedAt': 'Submitted At',\n      'createdAt': 'Created At',\n      'updatedAt': 'Updated At'\n    };\n    return fieldNames[fieldName] || fieldName.charAt(0).toUpperCase() + fieldName.slice(1);\n  };\n\n  // Helper function to format field values\n  const formatFieldValue = (fieldName, value) => {\n    if (value === null || value === undefined || value === '') {\n      return <span className=\"text-gray-400 italic\">Not accessible</span>;\n    }\n    \n    if (fieldName === 'status') {\n      return <span className={`badge ${getStatusBadge(value)}`}>{value}</span>;\n    }\n    \n    if (fieldName.includes('Hours') && typeof value === 'number') {\n      return value.toFixed(2);\n    }\n    \n    if (fieldName.includes('Date') || fieldName.includes('At')) {\n      return new Date(value).toLocaleDateString();\n    }\n    \n    return value;\n  };\n\n  // Helper function to determine if a field should be shown in the table\n  const shouldShowField = (fieldName) => {\n    // Always show these fields\n    const alwaysShow = ['status'];\n    if (alwaysShow.includes(fieldName)) return true;\n    \n    // Hide internal/system fields\n    const hideFields = ['id', 'userId', 'createdAt', 'updatedAt'];\n    if (hideFields.includes(fieldName)) return false;\n    \n    // Show all other fields that are available\n    return true;\n  };\n\n  // Helper function to get timesheet ID (since it might be filtered out)\n  const getTimesheetId = async (timesheet) => {\n    // If ID is available, use it\n    if (timesheet.id) {\n      return timesheet.id;\n    }\n    \n    // If ID is not available, we need to find it by matching other fields\n    // This is a fallback when the ID field is filtered out by Keycloak\n    try {\n      // Get all timesheets with full data to find the matching ID\n      const response = await apiClient.get('/timesheets');\n      const allTimesheets = response.data.content || response.data;\n      \n      // Find matching timesheet by comparing available fields\n      const matchingTimesheet = allTimesheets.find(t => \n        t.employeeName === timesheet.employeeName &&\n        t.location === timesheet.location &&\n        t.overtimeHours === timesheet.overtimeHours\n      );\n      \n      return matchingTimesheet?.id || null;\n    } catch (error) {\n      console.error('Error getting timesheet ID:', error);\n      return null;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-ca-secondary-50\">\n      {/* Header */}\n      <div className=\"ca-header\">\n        <div className=\"container\">\n          <div className=\"flex justify-between items-center py-4\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"ca-logo\">CA</div>\n              <h1 className=\"text-xl font-bold text-ca-primary-900\">Timesheet Management</h1>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <span className=\"text-sm text-ca-primary-700\">\n                {user?.username} ({user?.role})\n              </span>\n              {allowedActions.length > 0 && (\n                <span className=\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded\">\n                  Actions: {allowedActions.join(', ')}\n                </span>\n              )}\n              {allowedActions.length === 0 && (\n                <span className=\"text-xs bg-red-100 text-red-800 px-2 py-1 rounded\">\n                  No actions configured\n                </span>\n              )}\n              <button onClick={() => navigate('/')} className=\"btn btn-outline\">\n                Back to Dashboard\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"container py-8\">\n        {/* Alerts */}\n        {error && (\n          <div className=\"alert alert-error mb-4\">\n            {error}\n          </div>\n        )}\n        {success && (\n          <div className=\"alert alert-success mb-4\">\n            {success}\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"mb-6 flex justify-between items-center\">\n          <h2 className=\"text-2xl font-bold text-ca-primary-900\">My Timesheets</h2>\n          {/* Show \"New Timesheet\" button only if user has 'create' action permission */}\n          {allowedActions.includes('create') && (\n            <button\n              onClick={() => {\n                if (showForm) {\n                  setShowForm(false);\n                  setEditingTimesheet(null);\n                } else {\n                  setShowForm(true);\n                  setEditingTimesheet(null);\n                  setError('');\n                  setSuccess('');\n                }\n              }}\n              className=\"btn btn-primary\"\n            >\n              {showForm ? 'Cancel' : '+ New Timesheet'}\n            </button>\n          )}\n        </div>\n\n        {/* Timesheet Form */}\n        {showForm && (\n          <div className=\"card mb-6\">\n            <div className=\"card-header\">\n              <h3 className=\"text-lg font-semibold text-ca-primary-900\">\n                {editingTimesheet ? 'Edit Timesheet' : 'Create New Timesheet'}\n              </h3>\n            </div>\n            <div className=\"card-body\">\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Pay Period Start Date *</label>\n                    <input\n                      type=\"date\"\n                      required\n                      className=\"input\"\n                      value={formData.payPeriodStart}\n                      onChange={(e) => setFormData({...formData, payPeriodStart: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Pay Period End Date *</label>\n                    <input\n                      type=\"date\"\n                      required\n                      className=\"input\"\n                      value={formData.payPeriodEnd}\n                      onChange={(e) => setFormData({...formData, payPeriodEnd: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Regular Hours</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      step=\"0.5\"\n                      className=\"input\"\n                      placeholder=\"e.g., 40\"\n                      value={formData.regularHours}\n                      onChange={(e) => setFormData({...formData, regularHours: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Overtime Hours</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      step=\"0.5\"\n                      className=\"input\"\n                      placeholder=\"e.g., 5\"\n                      value={formData.overtimeHours}\n                      onChange={(e) => setFormData({...formData, overtimeHours: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Department *</label>\n                    <input\n                      type=\"text\"\n                      required\n                      className=\"input\"\n                      placeholder=\"e.g., IT\"\n                      value={formData.department}\n                      onChange={(e) => setFormData({...formData, department: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Location *</label>\n                    <input\n                      type=\"text\"\n                      required\n                      className=\"input\"\n                      placeholder=\"e.g., Sacramento\"\n                      value={formData.location}\n                      onChange={(e) => setFormData({...formData, location: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label className=\"form-label\">Comments</label>\n                    <textarea\n                      className=\"input\"\n                      rows=\"3\"\n                      placeholder=\"Additional notes...\"\n                      value={formData.comments}\n                      onChange={(e) => setFormData({...formData, comments: e.target.value})}\n                    />\n                  </div>\n                </div>\n                <div className=\"flex justify-end space-x-2\">\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setShowForm(false);\n                      setEditingTimesheet(null);\n                      setFormData({\n                        startDate: '',\n                        endDate: '',\n                        hoursWorked: '',\n                        department: '',\n                        location: '',\n                        comments: ''\n                      });\n                    }}\n                    className=\"btn btn-secondary\"\n                  >\n                    Cancel\n                  </button>\n                  <button type=\"submit\" className=\"btn btn-primary\">\n                    {editingTimesheet ? 'Update' : 'Create'} Timesheet\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        )}\n\n        {/* Timesheets List */}\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"text-lg font-semibold text-ca-primary-900\">Timesheets</h3>\n          </div>\n          <div className=\"card-body\">\n            {loading ? (\n              <div className=\"text-center py-8\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-ca-highlight-600 mx-auto\"></div>\n                <p className=\"mt-4 text-ca-primary-600\">Loading timesheets...</p>\n              </div>\n            ) : timesheets.length === 0 ? (\n              <div className=\"text-center py-8 text-ca-primary-600\">\n                No timesheets found. Create your first timesheet!\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"table\">\n                  <thead>\n                    <tr>\n                      {/* Dynamically generate table headers based on available fields */}\n                      {availableFields.filter(shouldShowField).map((fieldName) => (\n                        <th key={fieldName}>{getFieldDisplayName(fieldName)}</th>\n                      ))}\n                      <th>Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {timesheets.map((timesheet) => (\n                      <tr key={timesheet.id}>\n                        {/* Dynamically generate table cells based on available fields */}\n                        {availableFields.filter(shouldShowField).map((fieldName) => (\n                          <td key={fieldName}>\n                            {formatFieldValue(fieldName, timesheet[fieldName])}\n                          </td>\n                        ))}\n                        <td>\n                          <div className=\"flex space-x-2\">\n                            {/* Dynamically render action buttons based on allowedActions from Keycloak */}\n                            {allowedActions.includes('edit') && (\n                              <button\n                                onClick={() => handleEdit(timesheet)}\n                                className=\"btn btn-sm btn-secondary\"\n                                title=\"Edit this timesheet\"\n                              >\n                                Edit\n                              </button>\n                            )}\n                            {allowedActions.includes('delete') && (\n                              <button\n                                onClick={() => handleDelete(timesheet)}\n                                className=\"btn btn-sm btn-danger\"\n                                title=\"Delete this timesheet\"\n                              >\n                                Delete\n                              </button>\n                            )}\n                            {allowedActions.includes('approve') && (\n                              <button\n                                onClick={() => handleApprove(timesheet)}\n                                className=\"btn btn-sm btn-success\"\n                                title=\"Approve this timesheet\"\n                              >\n                                Approve\n                              </button>\n                            )}\n                            {allowedActions.includes('reject') && (\n                              <button\n                                onClick={() => handleReject(timesheet)}\n                                className=\"btn btn-sm btn-danger\"\n                                title=\"Reject this timesheet\"\n                              >\n                                Reject\n                              </button>\n                            )}\n                            {allowedActions.length === 0 && (\n                              <span className=\"text-gray-400 italic text-sm\">\n                                No actions available\n                                <br />\n                                <span className=\"text-xs\">(Add provider_actions in Keycloak)</span>\n                              </span>\n                            )}\n                            {allowedActions.length > 0 && !timesheet.id && (\n                              <span className=\"text-yellow-600 italic text-sm\">\n                                Actions available but ID missing\n                                <br />\n                                <span className=\"text-xs\">(Add \"id\" to provider_read_fields in Keycloak)</span>\n                              </span>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TimesheetManagement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}