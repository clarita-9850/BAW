{"ast":null,"code":"import React,{useState,useEffect}from'react';import{apiClient as api}from'../config/api';import'./NotificationCenter.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NotificationCenter=_ref=>{let{userId}=_ref;const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const[isOpen,setIsOpen]=useState(false);const[loading,setLoading]=useState(false);useEffect(()=>{fetchNotifications();fetchUnreadCount();// Poll for new notifications every 5 seconds\nconst interval=setInterval(()=>{fetchNotifications();fetchUnreadCount();},5000);return()=>clearInterval(interval);},[userId]);const fetchNotifications=async()=>{try{const response=await api.get(\"/notifications/user/\".concat(userId));setNotifications(response.data);}catch(error){console.error('Error fetching notifications:',error);}};const fetchUnreadCount=async()=>{try{const response=await api.get(\"/notifications/unread-count/\".concat(userId));// Ensure we convert to number in case backend returns string or other format\nconst count=typeof response.data==='number'?response.data:parseInt(response.data,10)||0;setUnreadCount(count);console.log(\"Unread count for \".concat(userId,\":\"),count);}catch(error){console.error('Error fetching unread count:',error);setUnreadCount(0);}};const markAsRead=async notificationId=>{try{await api.put(\"/notifications/\".concat(notificationId,\"/read\"));fetchNotifications();fetchUnreadCount();}catch(error){console.error('Error marking notification as read:',error);}};const markAllAsRead=async()=>{try{await api.put(\"/notifications/user/\".concat(userId,\"/read-all\"));fetchNotifications();fetchUnreadCount();}catch(error){console.error('Error marking all as read:',error);}};const getNotificationIcon=type=>{switch(type){case'ALERT':return'âš ï¸';case'WARNING':return'âš ï¸';case'SUCCESS':return'âœ…';case'INFO':return'â„¹ï¸';default:return'ðŸ“¢';}};const getNotificationColor=type=>{switch(type){case'ALERT':return'#dc3545';case'WARNING':return'#ffc107';case'SUCCESS':return'#28a745';case'INFO':return'#17a2b8';default:return'#6c757d';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"notification-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notification-bell-container\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"notification-bell\",onClick:()=>setIsOpen(!isOpen),children:[\"\\uD83D\\uDD14\",unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"notification-badge\",children:unreadCount})]}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"notification-dropdown\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notification-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Notifications\"}),unreadCount>0&&/*#__PURE__*/_jsx(\"button\",{className:\"mark-all-read-btn\",onClick:markAllAsRead,children:\"Mark all as read\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"notification-list\",children:notifications.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-notifications\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No notifications\"})}):notifications.slice(0,10).map(notification=>/*#__PURE__*/_jsxs(\"div\",{className:\"notification-item \".concat(!notification.readStatus?'unread':''),onClick:()=>{if(!notification.readStatus){markAsRead(notification.id);}if(notification.actionLink){window.location.href=notification.actionLink;}},children:[/*#__PURE__*/_jsx(\"div\",{className:\"notification-icon\",style:{backgroundColor:getNotificationColor(notification.notificationType)},children:getNotificationIcon(notification.notificationType)}),/*#__PURE__*/_jsxs(\"div\",{className:\"notification-content\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"notification-message\",children:notification.message}),/*#__PURE__*/_jsx(\"span\",{className:\"notification-time\",children:new Date(notification.createdAt).toLocaleString()})]}),!notification.readStatus&&/*#__PURE__*/_jsx(\"div\",{className:\"unread-indicator\"})]},notification.id))}),notifications.length>10&&/*#__PURE__*/_jsx(\"div\",{className:\"notification-footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"view-all-btn\",children:\"View all notifications\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"notification-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:unreadCount}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Unread\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:notifications.length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total\"})]})]})]});};export default NotificationCenter;","map":{"version":3,"names":["React","useState","useEffect","apiClient","api","jsx","_jsx","jsxs","_jsxs","NotificationCenter","_ref","userId","notifications","setNotifications","unreadCount","setUnreadCount","isOpen","setIsOpen","loading","setLoading","fetchNotifications","fetchUnreadCount","interval","setInterval","clearInterval","response","get","concat","data","error","console","count","parseInt","log","markAsRead","notificationId","put","markAllAsRead","getNotificationIcon","type","getNotificationColor","className","children","onClick","length","slice","map","notification","readStatus","id","actionLink","window","location","href","style","backgroundColor","notificationType","message","Date","createdAt","toLocaleString"],"sources":["/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/src/components/NotificationCenter.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { apiClient as api } from '../config/api';\nimport './NotificationCenter.css';\n\nconst NotificationCenter = ({ userId }) => {\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [isOpen, setIsOpen] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    fetchNotifications();\n    fetchUnreadCount();\n    \n    // Poll for new notifications every 5 seconds\n    const interval = setInterval(() => {\n      fetchNotifications();\n      fetchUnreadCount();\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, [userId]);\n\n  const fetchNotifications = async () => {\n    try {\n      const response = await api.get(`/notifications/user/${userId}`);\n      setNotifications(response.data);\n    } catch (error) {\n      console.error('Error fetching notifications:', error);\n    }\n  };\n\n  const fetchUnreadCount = async () => {\n    try {\n      const response = await api.get(`/notifications/unread-count/${userId}`);\n      // Ensure we convert to number in case backend returns string or other format\n      const count = typeof response.data === 'number' ? response.data : parseInt(response.data, 10) || 0;\n      setUnreadCount(count);\n      console.log(`Unread count for ${userId}:`, count);\n    } catch (error) {\n      console.error('Error fetching unread count:', error);\n      setUnreadCount(0);\n    }\n  };\n\n  const markAsRead = async (notificationId) => {\n    try {\n      await api.put(`/notifications/${notificationId}/read`);\n      fetchNotifications();\n      fetchUnreadCount();\n    } catch (error) {\n      console.error('Error marking notification as read:', error);\n    }\n  };\n\n  const markAllAsRead = async () => {\n    try {\n      await api.put(`/notifications/user/${userId}/read-all`);\n      fetchNotifications();\n      fetchUnreadCount();\n    } catch (error) {\n      console.error('Error marking all as read:', error);\n    }\n  };\n\n  const getNotificationIcon = (type) => {\n    switch (type) {\n      case 'ALERT': return 'âš ï¸';\n      case 'WARNING': return 'âš ï¸';\n      case 'SUCCESS': return 'âœ…';\n      case 'INFO': return 'â„¹ï¸';\n      default: return 'ðŸ“¢';\n    }\n  };\n\n  const getNotificationColor = (type) => {\n    switch (type) {\n      case 'ALERT': return '#dc3545';\n      case 'WARNING': return '#ffc107';\n      case 'SUCCESS': return '#28a745';\n      case 'INFO': return '#17a2b8';\n      default: return '#6c757d';\n    }\n  };\n\n  return (\n    <div className=\"notification-center\">\n      <div className=\"notification-bell-container\">\n        <button \n          className=\"notification-bell\"\n          onClick={() => setIsOpen(!isOpen)}\n        >\n          ðŸ””\n          {unreadCount > 0 && (\n            <span className=\"notification-badge\">{unreadCount}</span>\n          )}\n        </button>\n\n        {isOpen && (\n          <div className=\"notification-dropdown\">\n            <div className=\"notification-header\">\n              <h3>Notifications</h3>\n              {unreadCount > 0 && (\n                <button \n                  className=\"mark-all-read-btn\"\n                  onClick={markAllAsRead}\n                >\n                  Mark all as read\n                </button>\n              )}\n            </div>\n\n            <div className=\"notification-list\">\n              {notifications.length === 0 ? (\n                <div className=\"no-notifications\">\n                  <p>No notifications</p>\n                </div>\n              ) : (\n                notifications.slice(0, 10).map(notification => (\n                  <div \n                    key={notification.id} \n                    className={`notification-item ${!notification.readStatus ? 'unread' : ''}`}\n                    onClick={() => {\n                      if (!notification.readStatus) {\n                        markAsRead(notification.id);\n                      }\n                      if (notification.actionLink) {\n                        window.location.href = notification.actionLink;\n                      }\n                    }}\n                  >\n                    <div className=\"notification-icon\" style={{ \n                      backgroundColor: getNotificationColor(notification.notificationType) \n                    }}>\n                      {getNotificationIcon(notification.notificationType)}\n                    </div>\n                    \n                    <div className=\"notification-content\">\n                      <p className=\"notification-message\">{notification.message}</p>\n                      <span className=\"notification-time\">\n                        {new Date(notification.createdAt).toLocaleString()}\n                      </span>\n                    </div>\n                    \n                    {!notification.readStatus && (\n                      <div className=\"unread-indicator\"></div>\n                    )}\n                  </div>\n                ))\n              )}\n            </div>\n\n            {notifications.length > 10 && (\n              <div className=\"notification-footer\">\n                <button className=\"view-all-btn\">View all notifications</button>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      <div className=\"notification-stats\">\n        <div className=\"stat-item\">\n          <div className=\"stat-value\">{unreadCount}</div>\n          <div className=\"stat-label\">Unread</div>\n        </div>\n        <div className=\"stat-item\">\n          <div className=\"stat-value\">{notifications.length}</div>\n          <div className=\"stat-label\">Total</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NotificationCenter;\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}