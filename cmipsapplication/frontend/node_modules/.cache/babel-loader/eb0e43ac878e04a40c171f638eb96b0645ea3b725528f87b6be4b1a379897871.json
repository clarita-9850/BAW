{"ast":null,"code":"import _objectSpread from\"/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import'../styles/ChangePasswordModal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_BASE_URL||'http://localhost:8081';const ChangePasswordModal=_ref=>{let{isOpen,onClose,onSuccess}=_ref;const navigate=useNavigate();const[formData,setFormData]=useState({currentPassword:'',newPassword:'',confirmPassword:''});const[error,setError]=useState('');const[loading,setLoading]=useState(false);const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));setError('');// Clear error when user types\n};const validateForm=()=>{if(!formData.currentPassword){setError('Current password is required');return false;}if(!formData.newPassword){setError('New password is required');return false;}if(formData.newPassword.length<8){setError('New password must be at least 8 characters long');return false;}if(formData.newPassword!==formData.confirmPassword){setError('New passwords do not match');return false;}if(formData.currentPassword===formData.newPassword){setError('New password must be different from current password');return false;}return true;};const handleSubmit=async e=>{e.preventDefault();setError('');if(!validateForm()){return;}setLoading(true);try{// Get token from localStorage\nconst token=localStorage.getItem('token');const response=await axios.post(\"\".concat(API_BASE_URL,\"/api/auth/change-password\"),{currentPassword:formData.currentPassword,newPassword:formData.newPassword},{headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(response.data.success){// Clear form\nsetFormData({currentPassword:'',newPassword:'',confirmPassword:''});// Call success callback\nif(onSuccess){onSuccess();}// Close modal\nonClose();// Navigate to dashboard\nnavigate('/');}}catch(error){var _error$response,_error$response$data;console.error('Password change error:',error);if((_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&_error$response$data.error){setError(error.response.data.error);}else{setError('Failed to change password. Please try again.');}}finally{setLoading(false);}};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"change-password-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"change-password-modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"change-password-modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Change Password Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"change-password-modal-subtitle\",children:\"You must change your password before continuing.\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"change-password-form\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"change-password-error\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"change-password-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"currentPassword\",children:\"Current Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"currentPassword\",name:\"currentPassword\",value:formData.currentPassword,onChange:handleChange,required:true,autoFocus:true,disabled:loading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"change-password-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newPassword\",children:\"New Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newPassword\",name:\"newPassword\",value:formData.newPassword,onChange:handleChange,required:true,disabled:loading,minLength:8}),/*#__PURE__*/_jsx(\"small\",{children:\"Must be at least 8 characters long\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"change-password-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"confirmPassword\",children:\"Confirm New Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"confirmPassword\",name:\"confirmPassword\",value:formData.confirmPassword,onChange:handleChange,required:true,disabled:loading,minLength:8})]}),/*#__PURE__*/_jsx(\"div\",{className:\"change-password-form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"change-password-btn-primary\",disabled:loading,children:loading?'Changing Password...':'Change Password'})})]})]})});};export default ChangePasswordModal;","map":{"version":3,"names":["React","useState","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","ChangePasswordModal","_ref","isOpen","onClose","onSuccess","navigate","formData","setFormData","currentPassword","newPassword","confirmPassword","error","setError","loading","setLoading","handleChange","e","_objectSpread","target","name","value","validateForm","length","handleSubmit","preventDefault","token","localStorage","getItem","response","post","concat","headers","data","success","_error$response","_error$response$data","console","className","onClick","children","stopPropagation","onSubmit","htmlFor","type","id","onChange","required","autoFocus","disabled","minLength"],"sources":["/Users/sajeev/Documents/cmips-security/cmipsapplication/frontend/src/components/ChangePasswordModal.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport '../styles/ChangePasswordModal.css';\n\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:8081';\n\nconst ChangePasswordModal = ({ isOpen, onClose, onSuccess }) => {\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    currentPassword: '',\n    newPassword: '',\n    confirmPassword: '',\n  });\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value,\n    });\n    setError(''); // Clear error when user types\n  };\n\n  const validateForm = () => {\n    if (!formData.currentPassword) {\n      setError('Current password is required');\n      return false;\n    }\n    \n    if (!formData.newPassword) {\n      setError('New password is required');\n      return false;\n    }\n    \n    if (formData.newPassword.length < 8) {\n      setError('New password must be at least 8 characters long');\n      return false;\n    }\n    \n    if (formData.newPassword !== formData.confirmPassword) {\n      setError('New passwords do not match');\n      return false;\n    }\n    \n    if (formData.currentPassword === formData.newPassword) {\n      setError('New password must be different from current password');\n      return false;\n    }\n    \n    return true;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setLoading(true);\n    \n    try {\n      // Get token from localStorage\n      const token = localStorage.getItem('token');\n      \n      const response = await axios.post(\n        `${API_BASE_URL}/api/auth/change-password`,\n        {\n          currentPassword: formData.currentPassword,\n          newPassword: formData.newPassword,\n        },\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Content-Type': 'application/json',\n          },\n        }\n      );\n      \n      if (response.data.success) {\n        // Clear form\n        setFormData({\n          currentPassword: '',\n          newPassword: '',\n          confirmPassword: '',\n        });\n        \n        // Call success callback\n        if (onSuccess) {\n          onSuccess();\n        }\n        \n        // Close modal\n        onClose();\n        \n        // Navigate to dashboard\n        navigate('/');\n      }\n    } catch (error) {\n      console.error('Password change error:', error);\n      if (error.response?.data?.error) {\n        setError(error.response.data.error);\n      } else {\n        setError('Failed to change password. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"change-password-modal-overlay\" onClick={onClose}>\n      <div className=\"change-password-modal-content\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"change-password-modal-header\">\n          <h2>Change Password Required</h2>\n          <p className=\"change-password-modal-subtitle\">\n            You must change your password before continuing.\n          </p>\n        </div>\n        \n        <form onSubmit={handleSubmit} className=\"change-password-form\">\n          {error && (\n            <div className=\"change-password-error\">\n              {error}\n            </div>\n          )}\n          \n          <div className=\"change-password-form-group\">\n            <label htmlFor=\"currentPassword\">Current Password *</label>\n            <input\n              type=\"password\"\n              id=\"currentPassword\"\n              name=\"currentPassword\"\n              value={formData.currentPassword}\n              onChange={handleChange}\n              required\n              autoFocus\n              disabled={loading}\n            />\n          </div>\n          \n          <div className=\"change-password-form-group\">\n            <label htmlFor=\"newPassword\">New Password *</label>\n            <input\n              type=\"password\"\n              id=\"newPassword\"\n              name=\"newPassword\"\n              value={formData.newPassword}\n              onChange={handleChange}\n              required\n              disabled={loading}\n              minLength={8}\n            />\n            <small>Must be at least 8 characters long</small>\n          </div>\n          \n          <div className=\"change-password-form-group\">\n            <label htmlFor=\"confirmPassword\">Confirm New Password *</label>\n            <input\n              type=\"password\"\n              id=\"confirmPassword\"\n              name=\"confirmPassword\"\n              value={formData.confirmPassword}\n              onChange={handleChange}\n              required\n              disabled={loading}\n              minLength={8}\n            />\n          </div>\n          \n          <div className=\"change-password-form-actions\">\n            <button\n              type=\"submit\"\n              className=\"change-password-btn-primary\"\n              disabled={loading}\n            >\n              {loading ? 'Changing Password...' : 'Change Password'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default ChangePasswordModal;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}